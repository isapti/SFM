<?xml version="1.0" encoding="UTF-8"?>
<RuleList messageAPIVersion="M060100" applicationVersion="601001.6.0.20211102082900_f0rapt61" rulesCatalogVersion="4.4.20181016" ruleExportVersion="3.0"><Rule ruleId="50217" baseRuleId="50191" version="1" type="Authorization" multiOrgKey="AD" multiOrgName="DIGITAL" workflow="Production" queue="R_IB - Low Priority Queue" executionOrderType="0" guidedRuleType="1"><name><![CDATA[[Digital] - Rule 1]]></name><code><![CDATA[if ((TBT_TRAN_AMT >  10000)
& (TPP_CNTRY_CODE EQ '716'))
then do;
%Action_Alert;
%Action_Decline();
end;]]></code><desc><![CDATA[High amount transaction to risky country]]></desc><alertReason><![CDATA[High amount transfer to Zimbabwe]]></alertReason><alertType><![CDATA[X]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/><expressions><![CDATA[{"type":"ExpressionList","properties":{},"expressions":[{"type":"IF","properties":{"view":"grid","panelData":"{\"F-1\":{\"groupBy\":false, \"from\":10000, \"to\":10000}}"},"thenActions":[{"version":1,"id":50101,"name":null,"description":null,"alertAction":false},{"version":1,"id":50108,"name":null,"description":null,"alertAction":false}],"condition":{"type":"AND","properties":null,"operator":"AND","expressions":[{"type":"COMPARE","operator":"GT","fieldId":570,"fieldType":"Currency","fieldName":"TBT_TRAN_AMT","value":"10000"},{"type":"COMPARE","operator":"EQUAL","fieldId":673,"fieldType":"Character","fieldName":"TPP_CNTRY_CODE","value":"716"}]}}]}]]></expressions></Rule><Rule ruleId="50241" baseRuleId="50192" version="3" type="Authorization" multiOrgKey="AD" multiOrgName="DIGITAL" workflow="Production" queue="R_IB - Low Priority Queue" executionOrderType="0"><name><![CDATA[[Digital] - Rule 2]]></name><code><![CDATA[IF %ListContains(denylisted_accounts,TPP_ACCT_NUM)
THEN DO;
 %Action_Alert;
 %Action_Decline;
END;]]></code><desc><![CDATA[Rule that prevents sending money to denylisted accounts.]]></desc><alertReason><![CDATA[Beneficiary account is denylisted]]></alertReason><alertType><![CDATA[X]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="50219" baseRuleId="50193" version="1" type="Authorization" multiOrgKey="AD" multiOrgName="DIGITAL" workflow="Production" queue="R_IB - Low Priority Queue" executionOrderType="0"><name><![CDATA[[Digital] - Rule 3]]></name><code><![CDATA[%DeclareArray(&rule.beneficiaries ,_o_last_beneficiaries_1 - _o_last_beneficiaries_20);

if smh_client_tran_type = 'SEPACT' and

  /* Customer changed the pasword in last 30 minutes  */
  (dhms(RQO_TRAN_DATE_ALT,0,0,RQO_TRAN_TIME_ALT) - _o_last_pass_chg_dt < dhms(0,0,30,0) and _o_last_pass_chg_dt NE .) AND

  /* Customer requested debit card reissue in 30 min */
  (dhms(RQO_TRAN_DATE_ALT,0,0,RQO_TRAN_TIME_ALT) - _o_last_DC_reissue_dt < dhms(0,0,30,0) and _o_last_DC_reissue_dt NE .) AND

  /* Beneficiary acoount number is new for this customer */
  %indexArray(&rule.beneficiaries,tpp_acct_num) = 0

  THEN DO;
   %Action_Decline;
   %Action_Alert;
   &rule.alert = 1;

end;

/* Update customer profiles */

if smh_client_tran_type = 'PassChg' then do;
  %set(_o_last_pass_chg_dt) = dhms(rqo_tran_date_alt,0,0,rqo_tran_time_alt);
end;

if smh_client_tran_type = 'DCreissue' then do;
  %set(_o_last_DC_reissue_dt) = dhms(rqo_tran_date_alt,0,0,rqo_tran_time_alt);
end;

if smh_client_tran_type = 'SEPACT' and &rule.alert NE 1 then do;
  %ShiftHistoryArray(&rule.beneficiaries);
  %set(_o_last_beneficiaries_1) = TPP_ACCT_NUM;
end;]]></code><desc><![CDATA[SIM SWAP]]></desc><alertReason><![CDATA[SIM SWAP]]></alertReason><alertType><![CDATA[X]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_cust_type" componentValue="N"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_acct_type" componentValue="NA"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="BT"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="F"/><component componentField="smh_channel_type" componentValue="T"/><component componentField="smh_channel_type" componentValue="S"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_channel_type" componentValue="N"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_type" componentValue="MI"/><component componentField="smh_activity_type" componentValue="MB"/><component componentField="smh_activity_type" componentValue="MR"/><component componentField="smh_activity_type" componentValue="MD"/><component componentField="smh_activity_type" componentValue="MS"/><component componentField="smh_activity_type" componentValue="ML"/><component componentField="smh_activity_type" componentValue="MC"/><component componentField="smh_activity_type" componentValue="MO"/><component componentField="smh_activity_type" componentValue="MP"/><component componentField="smh_activity_type" componentValue="ME"/><component componentField="smh_activity_type" componentValue="M2"/><component componentField="smh_activity_type" componentValue="M3"/><component componentField="smh_activity_type" componentValue="MM"/><component componentField="smh_activity_type" componentValue="MT"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DCC"/><component componentField="smh_activity_detail1" componentValue="DCQ"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><component componentField="smh_activity_detail1" componentValue="DUS"/><component componentField="smh_activity_detail1" componentValue="DCH"/><VariableList><Variable FieldBusinessName="_o_last_beneficiaries_4" FieldName="v03_str_00936_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_5" FieldName="v03_str_00968_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_6" FieldName="v03_str_01000_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_7" FieldName="v03_str_01032_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_8" FieldName="v03_str_01064_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_9" FieldName="v03_str_01096_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_10" FieldName="v03_str_01128_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_11" FieldName="v03_str_01160_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_12" FieldName="v03_str_01192_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_13" FieldName="v03_str_01224_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_14" FieldName="v03_str_01256_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_15" FieldName="v03_str_01288_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_16" FieldName="v03_str_01320_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_17" FieldName="v03_str_01352_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_18" FieldName="v03_str_01384_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_19" FieldName="v03_str_00760_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_20" FieldName="v03_str_00792_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_pass_chg_dt" FieldName="v03_num_00824_008" InitialValue="." FieldDesc="Variable in Online user id" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_dc_reissue_dt" FieldName="v03_num_00832_008" InitialValue="." FieldDesc="Variable in Online user id" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_1" FieldName="v03_str_00840_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_2" FieldName="v03_str_00872_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_beneficiaries_3" FieldName="v03_str_00904_032" InitialValue="" FieldDesc="Variable in Online user id" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="50220" baseRuleId="50194" version="1" type="Authorization" multiOrgKey="AD" multiOrgName="DIGITAL" workflow="Production" queue="R_IB - High Priority Queue" executionOrderType="0"><name><![CDATA[[Digital] - Rule 4]]></name><code><![CDATA[%DeclareArray(&rule.benef_amt ,_T_last_transfers_amt_1 - _T_last_transfers_amt_5);
%DeclareArray(&rule.benef_dt  ,_T_last_transfers_dt_1 - _T_last_transfers_dt_5);

&rule.minutes = 10;
&rule.cumulative_amt = 20000;


if smh_client_tran_type = 'Fundtransf' then do;

/* Customer profiles update */
%shiftHistoryArray(&rule.benef_amt);
%set(_T_last_transfers_amt_1) = tbt_tran_amt;
%shiftHistoryArray(&rule.benef_dt);
%set(_T_last_transfers_dt_1) = dhms(rqo_tran_date,0,0,rqo_tran_time);

do &rule.i=1 to 5;
   if dhms(rqo_tran_date,0,0,rqo_tran_time) - %get(&rule.benef_dt,&rule.i) < dhms(0,0,&rule.minutes,0) and %get(&rule.benef_dt,&rule.i) ne . THEN DO;
   &rule.counter = sum(&rule.counter,1);
   &rule.amt = sum(&rule.amt,%get(&rule.benef_amt,&rule.i));
   end;
end;

if &rule.counter >= 3 and &rule.amt > &rule.cumulative_amt then do;
%Action_Alert;
%Action_Decline;
end;

end;

%Action_Return_Result(RUR_numeric_010,&rule.counter);]]></code><desc><![CDATA[Same Beneficiary getting multiple funds transfers from IB and/or MB]]></desc><alertReason><![CDATA[Same Beneficiary getting multiple funds transfers from IB and/or MB]]></alertReason><alertType><![CDATA[X]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_t_last_transfers_dt_4" FieldName="v06_num_00000_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_dt_5" FieldName="v06_num_00008_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_amt_2" FieldName="v06_num_00016_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_amt_1" FieldName="v06_num_00024_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_amt_4" FieldName="v06_num_00032_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_amt_3" FieldName="v06_num_00040_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_amt_5" FieldName="v06_num_00048_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_dt_1" FieldName="v06_num_00056_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_dt_2" FieldName="v06_num_00064_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_t_last_transfers_dt_3" FieldName="v06_num_00072_008" InitialValue="." FieldDesc="Variable in Beneficiary account" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="50221" baseRuleId="50195" version="1" type="Authorization" multiOrgKey="AD" multiOrgName="DIGITAL" workflow="Production" queue="R_IB - High Priority Queue" executionOrderType="0"><name><![CDATA[[Digital] - Rule 5]]></name><code><![CDATA[%DeclareArray(&rule.login_ip ,_x_login_ip_1 - _x_login_ip_5);
%DeclareArray(&rule.login_dt, _x_login_dt_1 - _x_login_dt_5);
%DeclareArray(&rule.login_new_flg, _x_login_new_flg_1 -  _x_login_new_flg_5);
%DeclareArray(&rule.login_addben, _x_login_added_ben_1 - _x_login_added_ben_5);


if smh_client_tran_type = 'Login' then do;

%ShiftHistoryArray(&rule.login_ip);
%ShiftHistoryArray(&rule.login_dt);
%ShiftHistoryArray(&rule.login_new_flg);
%ShiftHistoryArray(&rule.login_addben);

if %indexarray(&rule.login_ip,hob_ip_address) = 0 then %set(_x_login_new_flg_1) = 1;

%set(_x_login_ip_1) = hob_ip_address;
%set(_x_login_dt_1) = dhms(rqo_tran_date_alt,0,0,rqo_tran_time_alt);

end;


if smh_client_tran_type = 'Addbenef' and _x_login_new_flg_1 = 1 then do;
%set(_x_login_added_ben_1) =  _u_20byte_string_002;
end;

if smh_client_tran_type = 'Fundtransf' and _x_login_added_ben_1 = tpp_acct_num then do;
%Action_Alert;
%Action_Decline;
end;]]></code><desc><![CDATA[New IP address, used to access IB/MB of an existing IB/MB customer, new beneficiary added and immediate fund transfer done]]></desc><alertReason><![CDATA[New IP address, used to access IB/MB of an existing IB/MB customer, new beneficiary added and immediate fund transfer done]]></alertReason><alertType><![CDATA[X]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_cust_type" componentValue="N"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_acct_type" componentValue="NA"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="BT"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="F"/><component componentField="smh_channel_type" componentValue="T"/><component componentField="smh_channel_type" componentValue="S"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_channel_type" componentValue="N"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_type" componentValue="MI"/><component componentField="smh_activity_type" componentValue="MB"/><component componentField="smh_activity_type" componentValue="MR"/><component componentField="smh_activity_type" componentValue="MD"/><component componentField="smh_activity_type" componentValue="MS"/><component componentField="smh_activity_type" componentValue="ML"/><component componentField="smh_activity_type" componentValue="MC"/><component componentField="smh_activity_type" componentValue="MO"/><component componentField="smh_activity_type" componentValue="MP"/><component componentField="smh_activity_type" componentValue="ME"/><component componentField="smh_activity_type" componentValue="M2"/><component componentField="smh_activity_type" componentValue="M3"/><component componentField="smh_activity_type" componentValue="MM"/><component componentField="smh_activity_type" componentValue="MT"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DCC"/><component componentField="smh_activity_detail1" componentValue="DCQ"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><component componentField="smh_activity_detail1" componentValue="DUS"/><component componentField="smh_activity_detail1" componentValue="DCH"/><VariableList><Variable FieldBusinessName="_x_login_ip_3" FieldName="v05_str_00000_024" InitialValue="" FieldDesc="Variable in Customer" FieldLength="24" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_ip_2" FieldName="v05_str_00024_024" InitialValue="" FieldDesc="Variable in Customer" FieldLength="24" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_ip_5" FieldName="v05_str_00048_024" InitialValue="" FieldDesc="Variable in Customer" FieldLength="24" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_ip_4" FieldName="v05_str_00072_024" InitialValue="" FieldDesc="Variable in Customer" FieldLength="24" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_ip_1" FieldName="v05_str_00096_024" InitialValue="" FieldDesc="Variable in Customer" FieldLength="24" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_u_20byte_string_002" FieldName="rua_20byte_string_002" InitialValue="" FieldDesc="20-byte string" FieldLength="20" VariableType="Character" SegmentKeyFieldNames="" SegmentKeyFieldBusinessNames="" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_new_flg_5" FieldName="v05_num_00120_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_added_ben_1" FieldName="v05_str_00128_032" InitialValue="" FieldDesc="Variable in Customer" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_new_flg_3" FieldName="v05_num_00160_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_new_flg_4" FieldName="v05_num_00168_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_added_ben_4" FieldName="v05_str_00176_032" InitialValue="" FieldDesc="Variable in Customer" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_added_ben_5" FieldName="v05_str_00208_032" InitialValue="" FieldDesc="Variable in Customer" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_added_ben_2" FieldName="v05_str_00240_032" InitialValue="" FieldDesc="Variable in Customer" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_added_ben_3" FieldName="v05_str_00272_032" InitialValue="" FieldDesc="Variable in Customer" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_dt_3" FieldName="v05_num_00304_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_dt_2" FieldName="v05_num_00312_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_dt_1" FieldName="v05_num_00320_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_new_flg_2" FieldName="v05_num_00328_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_new_flg_1" FieldName="v05_num_00336_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_dt_5" FieldName="v05_num_00344_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_x_login_dt_4" FieldName="v05_num_00352_008" InitialValue="." FieldDesc="Variable in Customer" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="xqo_cust_num" SegmentKeyFieldBusinessNames="xqo_cust_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule></RuleList>