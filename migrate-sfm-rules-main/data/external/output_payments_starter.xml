<?xml version="1.0" encoding="UTF-8"?>
<RuleList messageAPIVersion="M060100" applicationVersion="601001.12.0.20220408090000_f0rapt61" rulesCatalogVersion="4.4.20181016" ruleExportVersion="3.0"><Rule ruleId="60237" baseRuleId="60235" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Beneficiary_Tracker]]></name><code><![CDATA[/*Array of UV storing beneficiary accounts*/
%DeclareArray(&rule.beneficiary, _o_beneficiary_1 - _o_beneficiary_11);
/*Array of UV storing the date when the beneficiary was 1st paid*/
%DeclareArray(&rule.firstpayment, _o_1st_paid_1 - _o_1st_paid_11);
/*Array of UV storing the date when the beneficiary was last paid*/
%DeclareArray(&rule.lastpayment, _o_last_paid_1 - _o_last_paid_11);
/*Array of UV storing the volume of payments that have been made to
the beneficiary*/
%DeclareArray(&rule.BNF_payment_vol , _o_vol_1 - _o_vol_11);
/*Array of UV storing the total amount paid to the beneficiary*/
%DeclareArray(&rule.total_amt , _o_tot_1 - _o_tot_11);
/*Array of UV storing the max amount paid to the beneficiary*/
%DeclareArray(&rule.max_amt , _o_max_1 - _o_max_11);

/* check array for beneficiary*/
&rule.index = %IndexArray(&rule.beneficiary , tpp_acct_num);

if &rule.index > 0
/*if beneficiary account present in array update last payment date,
   volume, total and max amounts*/
then do;

 %set(&rule.lastpayment,&rule.index)=rqo_tran_date;
 %set(&rule.BNF_payment_vol, &rule.index)=
                   %get(&rule.BNF_payment_vol,&rule.index) + 1;
 %set(&rule.total_amt, &rule.index) =
                   %get(&rule.total_amt, &rule.index) + tbt_tran_amt;

/*calculate relative difference of current amount and max amount
  before updating max array as if current amount is greater this
  will overwrite the max amount currently held*/
 if %get(&rule.max_amt, &rule.index)>= tbt_tran_amt
 then do;
   %set(_o_relative_diff) = 0;
 end;
 else do;
   %set(_o_relative_diff) = (tbt_tran_amt -
             %get(&rule.max_amt, &rule.index))/%get(&rule.max_amt, &rule.index);
    %set(&rule.max_amt, &rule.index)= tbt_tran_amt;
 end;

end;
/*otherwise replace oldest beneficiary with new one and
  update all related arrays*/
else do;

/*oldest beneficiary is determined by finding the oldest date in the
  last payment date array*/
 &rule.oldest= %IndexArray(&rule.lastpayment, (min(&&&rule.lastpayment)));
 %set(&rule.beneficiary, &rule.oldest) = tpp_acct_num;
 %set(&rule.firstpayment, &rule.oldest)= rqo_tran_date;
 %set(&rule.lastpayment, &rule.oldest) = rqo_tran_date;
 %set(&rule.BNF_payment_vol ,&rule.oldest) = 1;
 %set(&rule.total_amt, &rule.oldest)= tbt_tran_amt;
 %set(&rule.max_amt, &rule.oldest) = tbt_tran_amt;
 %set(_o_relative_diff) = 0;
end;]]></code><desc><![CDATA[Store last 10 (so 11 in total) new unique beneficiaries with date of 1st payment, date of last payments, current volume, total and max amounts of payments. Beneficiaries not already in the array replace the beneficiary that was last paid longest ago.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_1st_paid_1" FieldName="v03_num_00000_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00088_008"/><Variable FieldBusinessName="_o_1st_paid_2" FieldName="v03_num_00008_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00096_008"/><Variable FieldBusinessName="_o_1st_paid_3" FieldName="v03_num_00016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00104_008"/><Variable FieldBusinessName="_o_1st_paid_4" FieldName="v03_num_00024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00112_008"/><Variable FieldBusinessName="_o_1st_paid_5" FieldName="v03_num_00032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00120_008"/><Variable FieldBusinessName="_o_1st_paid_6" FieldName="v03_num_00040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00128_008"/><Variable FieldBusinessName="_o_1st_paid_7" FieldName="v03_num_00048_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00136_008"/><Variable FieldBusinessName="_o_1st_paid_8" FieldName="v03_num_00056_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00144_008"/><Variable FieldBusinessName="_o_1st_paid_9" FieldName="v03_num_00064_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00152_008"/><Variable FieldBusinessName="_o_1st_paid_10" FieldName="v03_num_00072_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00160_008"/><Variable FieldBusinessName="_o_1st_paid_11" FieldName="v03_num_00080_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00168_008"/><Variable FieldBusinessName="_o_last_paid_1" FieldName="v03_num_00088_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00176_008"/><Variable FieldBusinessName="_o_last_paid_2" FieldName="v03_num_00096_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00184_008"/><Variable FieldBusinessName="_o_beneficiary_1" FieldName="v03_str_00104_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_3" FieldName="v03_num_00144_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00192_008"/><Variable FieldBusinessName="_o_beneficiary_2" FieldName="v03_str_00152_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_4" FieldName="v03_num_00192_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00200_008"/><Variable FieldBusinessName="_o_beneficiary_3" FieldName="v03_str_00200_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_5" FieldName="v03_num_00240_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00208_008"/><Variable FieldBusinessName="_o_beneficiary_4" FieldName="v03_str_00248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_6" FieldName="v03_num_00288_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00216_008"/><Variable FieldBusinessName="_o_beneficiary_5" FieldName="v03_str_00296_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_7" FieldName="v03_num_00336_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00224_008"/><Variable FieldBusinessName="_o_beneficiary_6" FieldName="v03_str_00344_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_8" FieldName="v03_num_00384_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00232_008"/><Variable FieldBusinessName="_o_beneficiary_7" FieldName="v03_str_00392_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_9" FieldName="v03_num_00432_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00240_008"/><Variable FieldBusinessName="_o_beneficiary_8" FieldName="v03_str_00440_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_10" FieldName="v03_num_00480_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00248_008"/><Variable FieldBusinessName="_o_beneficiary_9" FieldName="v03_str_00488_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_last_paid_11" FieldName="v03_num_00528_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00256_008"/><Variable FieldBusinessName="_o_beneficiary_10" FieldName="v03_str_00536_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_vol_1" FieldName="v03_num_00576_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00264_008"/><Variable FieldBusinessName="_o_beneficiary_11" FieldName="v03_str_00584_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_vol_2" FieldName="v03_num_00624_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00272_008"/><Variable FieldBusinessName="_o_vol_3" FieldName="v03_num_00632_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00280_008"/><Variable FieldBusinessName="_o_vol_4" FieldName="v03_num_00640_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00288_008"/><Variable FieldBusinessName="_o_vol_5" FieldName="v03_num_00648_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00296_008"/><Variable FieldBusinessName="_o_vol_6" FieldName="v03_num_00656_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00304_008"/><Variable FieldBusinessName="_o_vol_7" FieldName="v03_num_00664_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00312_008"/><Variable FieldBusinessName="_o_vol_8" FieldName="v03_num_00672_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00320_008"/><Variable FieldBusinessName="_o_vol_9" FieldName="v03_num_00680_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00328_008"/><Variable FieldBusinessName="_o_vol_10" FieldName="v03_num_00688_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00336_008"/><Variable FieldBusinessName="_o_vol_11" FieldName="v03_num_00696_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00344_008"/><Variable FieldBusinessName="_o_tot_1" FieldName="v03_num_00704_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00352_008"/><Variable FieldBusinessName="_o_tot_2" FieldName="v03_num_00712_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00360_008"/><Variable FieldBusinessName="_o_tot_3" FieldName="v03_num_00720_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00368_008"/><Variable FieldBusinessName="_o_tot_4" FieldName="v03_num_00728_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00376_008"/><Variable FieldBusinessName="_o_tot_5" FieldName="v03_num_00736_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00384_008"/><Variable FieldBusinessName="_o_tot_6" FieldName="v03_num_00744_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00392_008"/><Variable FieldBusinessName="_o_tot_7" FieldName="v03_num_00752_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00400_008"/><Variable FieldBusinessName="_o_tot_8" FieldName="v03_num_00760_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00408_008"/><Variable FieldBusinessName="_o_tot_9" FieldName="v03_num_00768_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00416_008"/><Variable FieldBusinessName="_o_tot_10" FieldName="v03_num_00776_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00424_008"/><Variable FieldBusinessName="_o_tot_11" FieldName="v03_num_00784_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00432_008"/><Variable FieldBusinessName="_o_max_1" FieldName="v03_num_00792_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00440_008"/><Variable FieldBusinessName="_o_max_2" FieldName="v03_num_00800_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00448_008"/><Variable FieldBusinessName="_o_max_3" FieldName="v03_num_00808_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00456_008"/><Variable FieldBusinessName="_o_max_4" FieldName="v03_num_00816_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00464_008"/><Variable FieldBusinessName="_o_max_5" FieldName="v03_num_00824_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00472_008"/><Variable FieldBusinessName="_o_max_6" FieldName="v03_num_00832_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00480_008"/><Variable FieldBusinessName="_o_max_7" FieldName="v03_num_00840_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00488_008"/><Variable FieldBusinessName="_o_max_8" FieldName="v03_num_00848_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00496_008"/><Variable FieldBusinessName="_o_max_9" FieldName="v03_num_00856_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00504_008"/><Variable FieldBusinessName="_o_max_10" FieldName="v03_num_00864_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00512_008"/><Variable FieldBusinessName="_o_max_11" FieldName="v03_num_00872_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00520_008"/><Variable FieldBusinessName="_o_relative_diff" FieldName="v03_num_00880_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00528_008"/></VariableList></Rule><Rule ruleId="60238" baseRuleId="60236" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Payment_Value_and_Datetime_Tracker]]></name><code><![CDATA[/*Array of UV storing Beneficiary Account*/
%DeclareArray(&rule.BNF_acct, _o_bnf_acct_1 - _o_bnf_acct_11);
/*Array of UV storing Transaction Amounts*/
%DeclareArray(&rule.payment_amt , _o_amt_1 - _o_amt_11);
/*Array of UV storing Transaction Date and Time*/
%DeclareArray(&rule.payment_dt , _o_dt_1 - _o_dt_11);

/* Updating arrays with current transaction information*/
%ShiftHistoryArray(&rule.BNF_acct);
%ShiftHistoryArray(&rule.payment_amt);
%ShiftHistoryArray(&rule.payment_dt);
%set(_o_bnf_acct_1)= tpp_acct_num;
%set(_o_amt_1) = tbt_tran_amt;
%set(_o_dt_1) = dhms(rqo_tran_date,0,0,rqo_tran_time);

/*prev_max updated with maximum amount of previous 11 trans held in array*/
%set(_o_prev_max) = _o_curr_max;
/*curr_max updated with maximum amount of transactions now held in array*/
%set(_o_curr_max) = max(&&&rule.payment_amt);]]></code><desc><![CDATA[Store the amounts, beneficiary accounts, dates and times and maximum amount of the last 10 (so 11 in total) transactions.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_amt_3" FieldName="v03_num_01016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_2" FieldName="v03_num_01024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_5" FieldName="v03_num_01032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_4" FieldName="v03_num_01040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_2" FieldName="v03_str_01048_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_1" FieldName="v03_str_01088_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_4" FieldName="v03_str_01128_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_3" FieldName="v03_str_01168_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_6" FieldName="v03_str_01208_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_5" FieldName="v03_str_01248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_8" FieldName="v03_str_01288_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_7" FieldName="v03_str_01328_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_9" FieldName="v03_num_01368_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_10" FieldName="v03_num_01376_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_7" FieldName="v03_num_01384_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_8" FieldName="v03_num_01392_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_5" FieldName="v03_num_01400_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_6" FieldName="v03_num_01408_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_3" FieldName="v03_num_01416_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_4" FieldName="v03_num_01424_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_1" FieldName="v03_num_01432_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_2" FieldName="v03_num_01440_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_10" FieldName="v03_num_01448_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_11" FieldName="v03_num_01456_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_8" FieldName="v03_num_01464_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_9" FieldName="v03_num_01472_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_6" FieldName="v03_num_01480_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_7" FieldName="v03_num_01488_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_curr_max" FieldName="v03_num_01496_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_prev_max" FieldName="v03_num_01504_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_11" FieldName="v03_num_01512_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_10" FieldName="v03_str_00888_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_9" FieldName="v03_str_00928_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_1" FieldName="v03_num_00968_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_11" FieldName="v03_str_00976_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60239" baseRuleId="60237" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 2 - Other Malware" executionOrderType="0"><name><![CDATA[International_Payment_Tracker]]></name><code><![CDATA[/*Array to store country codes of payments*/
%DeclareArray(&rule.intl_payments,_o_intl_1-_o_intl_4);
/*customer country code not equal to the beneficiary bank country code*/
if xqo_cust_cntry_code ne tpp_bank_cntry_code
/*beneficiary bank country code not already held in array*/
and %IndexArray(&rule.intl_payments, tpp_bank_cntry_code ) = 0
then do;
 %ShiftHistoryArray(&rule.intl_payments);
 %set(_o_intl_1) = tpp_bank_cntry_code;
end;]]></code><desc><![CDATA[Store of the last 4 international beneficiary bank country codes, including the current transaction if international, that the customer has made payments to.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_intl_3" FieldName="v03_str_01528_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_intl_4" FieldName="v03_str_01536_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_intl_1" FieldName="v03_str_01544_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_intl_2" FieldName="v03_str_01520_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60240" baseRuleId="60238" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 3 - Gross Loss fraud" executionOrderType="0"><name><![CDATA[First_Payment]]></name><code><![CDATA[if _o_first_payment_date = 0 /*never made a payment*/
then %set(_o_first_payment_date) = rqo_tran_date;]]></code><desc><![CDATA[Store date of first payment ever made by customer.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_first_payment_date" FieldName="v03_num_01552_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60241" baseRuleId="60239" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Me_to_Me_Transaction]]></name><code><![CDATA[if tbt_self_acct_ind = 'Y' /*indicates Me-To-Me transaction*/
and tbt_tran_amt > min(aqd_avail_bal,hqo_limit_amt) * 0.8

then %set(_o_me_to_me) = dhms(rqo_tran_date,0,0,rqo_tran_time);]]></code><desc><![CDATA[Store date and time of a me-to-me transaction if the transaction amount is >80% of the minimum of the account balance and the limit for the transfer type.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_me_to_me" FieldName="v03_num_01560_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60242" baseRuleId="60240" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[First_Online_Session_DT]]></name><code><![CDATA[if _o_1st_online_session = 0 /*never logged into online banking*/
then %set(_o_1st_online_session)= dhms(hob_logon_date,0,0, hob_logon_time);]]></code><desc><![CDATA[Store date and time of first online session]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_1st_online_session" FieldName="v03_num_01568_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60243" baseRuleId="60241" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Change_of_Details_Tracker]]></name><code><![CDATA[/*Array to store dates of detail changes*/
%DeclareArray(&rule.change , _o_change_dt_1 - _o_change_dt_3);

if tng_tran_type in ('GA','GP')/*Address and Phone number non mon changes*/
then do;
 /*Only update array if detail changes haven't already been made that day*/
 if %Indexarray(&rule.change, rqo_tran_date) = 0
 then do;
 %shiftHistoryArray(&rule.change);
 %set(_o_change_dt_1) = rqo_tran_date;
 end;
end;]]></code><desc><![CDATA[Store the dates of last 3 detail/non-mon changes on separate days]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_change_dt_3" FieldName="v03_num_01576_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_change_dt_2" FieldName="v03_num_01584_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_change_dt_1" FieldName="v03_num_01592_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60244" baseRuleId="60242" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Payments_to_BNF]]></name><code><![CDATA[/*Array of UV storing unique online user Ids*/
%DeclareArray(&rule.online_id, _B_ONLINE_ID_1 - _B_ONLINE_ID_11);
/*Array of UV storing the date the beneficiary was paid by the customer*/
%DeclareArray(&rule.paidintodt, _B_PAIDINTODT_1 - _B_PAIDINTODT_11);

/* check array for online user ID*/
&rule.index = %IndexArray(&rule.online_id, hqo_ob_userid);
/*If the customer has paid this beneficiary before then update
paidintodt with current transaction date and time */
if &rule.index > 0
then %set(&rule.paidintodt,&rule.index)=dhms(rqo_tran_date,0,0,rqo_tran_time);
else do;
/*otherwise replace oldest payer with new one and update paidintodt array*/
&rule.oldest= %IndexArray(&rule.paidintodt, (min(&&&rule.paidintodt)));

%set(&rule.online_id, &rule.oldest) = hqo_ob_userid ;
%set(&rule.paidintodt, &rule.oldest) = dhms(rqo_tran_date,0,0,rqo_tran_time);

end;]]></code><desc><![CDATA[Store customer Id's and date and time for transactions paid to a beneficiary
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_b_paidintodt_1" FieldName="v06_num_00000_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_2" FieldName="v06_num_00008_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_3" FieldName="v06_num_00016_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_4" FieldName="v06_num_00024_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_5" FieldName="v06_num_00032_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_6" FieldName="v06_num_00040_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_7" FieldName="v06_num_00048_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_8" FieldName="v06_num_00056_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_9" FieldName="v06_num_00064_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_10" FieldName="v06_num_00072_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_paidintodt_11" FieldName="v06_num_00080_008" InitialValue="0" FieldDesc="Variable in Beneficiary" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_1" FieldName="v06_str_00088_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_2" FieldName="v06_str_00144_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_3" FieldName="v06_str_00200_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_4" FieldName="v06_str_00256_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_5" FieldName="v06_str_00312_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_6" FieldName="v06_str_00368_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_7" FieldName="v06_str_00424_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_8" FieldName="v06_str_00480_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_9" FieldName="v06_str_00536_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_10" FieldName="v06_str_00592_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_b_online_id_11" FieldName="v06_str_00648_056" InitialValue="" FieldDesc="Variable in Beneficiary" FieldLength="56" VariableType="Character" SegmentKeyFieldNames="tpp_acct_num" SegmentKeyFieldBusinessNames="tpp_acct_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60245" baseRuleId="60243" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Language_Change_Tracker]]></name><code><![CDATA[/*update previous language info from the last transaction*/
%set(_o_prev_lang) = _o_current_lang;
%set(_o_prev_lang_dt) = _o_current_lang_dt;


/* update current language info from the current transaction*/
%set(_o_current_lang)= hdf_http_accept_lang;
%set(_o_current_lang_dt)= dhms(rqo_tran_date,0,0,rqo_tran_time);]]></code><desc><![CDATA[Store Customer's preferred language and dates and times of any changes to this.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_current_lang" FieldName="v03_str_01600_032" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_prev_lang" FieldName="v03_str_01632_032" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_current_lang_dt" FieldName="v03_num_01664_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_prev_lang_dt" FieldName="v03_num_01672_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60246" baseRuleId="60244" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Device_Type_Tracker]]></name><code><![CDATA[/*Array of UV storing Device Types used*/
%DeclareArray(&rule.device_type, _o_device_1, _o_device_2, _o_device_3);
/*Array of UV storing first time device type used*/
%DeclareArray(&rule.device_date,_o_device_date_1,
                                    _o_device_date_2, _o_device_date_3);

/*Device type not in array and so has never been used*/
if %IndexArray(&rule.device_type, hob_device) = 0
then do;
 /*update array with new device type*/
 %ShiftHistoryArray(&rule.device_type);
 %ShiftHistoryArray(&rule.device_date);
 %set(_o_device_1) = hob_device;
 %set(_o_device_date_1) = rqo_tran_date;
end;]]></code><desc><![CDATA[Store previous device types used by the customer and dates when first used.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_device_date_1" FieldName="v03_num_01704_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_date_2" FieldName="v03_num_01712_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_date_3" FieldName="v03_num_01720_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_1" FieldName="v03_str_01680_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_2" FieldName="v03_str_01688_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_3" FieldName="v03_str_01696_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60247" baseRuleId="60245" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Browser_Tracker]]></name><code><![CDATA[/*Array of UV storing Browsers used*/
%DeclareArray(&rule.browser, _o_browser_1, _o_browser_2, _o_browser_3);
/*Array of UV storing first time browser is used*/
%DeclareArray(&rule.browser_date,_o_browser_date_1,
                                 _o_browser_date_2, _o_browser_date_3);

/* browser not in array and so has never been used*/
if %IndexArray(&rule.browser, hdf_bwsr_type) = 0
then do;
 /*update array with new browser info*/
 %ShiftHistoryArray(&rule.browser);
 %ShiftHistoryArray(&rule.browser_date);
 %set(_o_browser_1) = hdf_bwsr_type;
 %set(_o_browser_date_1) = rqo_tran_date;
end;]]></code><desc><![CDATA[Store previous web browsers used by the customer and dates when the browsers were first used.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_browser_1" FieldName="v03_str_01728_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_2" FieldName="v03_str_01736_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_3" FieldName="v03_str_01744_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_date_1" FieldName="v03_num_01752_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_date_2" FieldName="v03_num_01760_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_date_3" FieldName="v03_num_01768_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60248" baseRuleId="60246" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[OS_Tracker]]></name><code><![CDATA[/*Array of UV storing Operating Systems used*/
%DeclareArray(&rule.os, _o_os_1, _o_os_2, _o_os_3);
/*Array of UV storing first time Operating System used*/
%DeclareArray(&rule.os_date,_o_os_date_1, _o_os_date_2, _o_os_date_3);

/*OS not in array so OS has never been used*/
if %IndexArray(&rule.os, hdf_bwsr_os) = 0
then do;
 /*update array with new OS info*/
 %ShiftHistoryArray(&rule.os);
 %ShiftHistoryArray(&rule.os_date);
 %set(_o_os_1) = hdf_bwsr_os;
 %set(_o_os_date_1) = rqo_tran_date;
end;]]></code><desc><![CDATA[Store previous operating systems used by the customer and dates when they were first used.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_os_1" FieldName="v03_str_01776_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_2" FieldName="v03_str_01784_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_3" FieldName="v03_str_01792_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_date_1" FieldName="v03_num_01800_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_date_2" FieldName="v03_num_01808_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_date_3" FieldName="v03_num_01816_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60249" baseRuleId="60247" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Password_Change_Tracker]]></name><code><![CDATA[if tng_tran_type = 'GS'/*Password non mon change*/
then do;
  %set(_o_passwd_change) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store date and time of password change]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_passwd_change" FieldName="v03_num_01824_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60250" baseRuleId="60248" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Auth_Settings_Tracker]]></name><code><![CDATA[if tng_tran_type = 'AS'/*Authorisation settings non mon change*/
then do;
  %set(_o_auth_settings_change) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store date and time of authorisation requirements change]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_auth_settings_change" FieldName="v03_num_01832_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60251" baseRuleId="60249" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[OverLimit_Transaction]]></name><code><![CDATA[if tbt_tran_amt > aqd_avail_bal
then %set(_o_over_limit) = dhms(rqo_tran_date,0,0,rqo_tran_time);]]></code><desc><![CDATA[Store date and time of a transaction if the transaction amount is greater than the available account balance.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_over_limit" FieldName="v03_num_01840_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60252" baseRuleId="60250" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" executionOrderType="0"><name><![CDATA[Failed_Login_Tracker]]></name><code><![CDATA[/*Array of UV storing date and time of last failed logins*/
%DeclareArray(&rule.failedlogin, _o_failed_1 - _o_failed_3);

if tng_tran_type = 'FL'   /*Failed Login non mon*/

then do;
  %ShiftHistoryArray(&rule.failedlogin);
  %set(_o_failed_1) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store date , time and count of the number of login failures]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_failed_1" FieldName="v03_num_01848_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_failed_2" FieldName="v03_num_01856_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_failed_3" FieldName="v03_num_01864_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60253" baseRuleId="60251" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[No_Description]]></name><code><![CDATA[/*Array of UV storing beneficiary accounts*/
%DeclareArray(&rule.beneficiary, _o_beneficiary_1 - _o_beneficiary_11);
/*Array of UV storing the volume of payments that have
been made to the beneficiary*/
%DeclareArray(&rule.BNF_payment_vol , _o_vol_1 - _o_vol_11);

/*locate beneficiary in array*/
&rule.index = %IndexArray(&rule.beneficiary, tpp_acct_num);

/*check if the payment volume to that beneficiary is 1*/
/*indicating that beneficiary hasn't been seen in last 10 beneficiaries*/
if %get(&rule.BNF_payment_vol, &rule.index) = 1

/* description only contains hyphens/underscores/zeros/spaces*/
and lengthn(compress(tpp_description, '-_0 ')) = 0
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[New beneficiary created without a valid description field value
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_vol_7" FieldName="v03_num_00664_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00312_008"/><Variable FieldBusinessName="_o_vol_8" FieldName="v03_num_00672_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00320_008"/><Variable FieldBusinessName="_o_vol_9" FieldName="v03_num_00680_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00328_008"/><Variable FieldBusinessName="_o_vol_10" FieldName="v03_num_00688_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00336_008"/><Variable FieldBusinessName="_o_vol_11" FieldName="v03_num_00696_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00344_008"/><Variable FieldBusinessName="_o_beneficiary_1" FieldName="v03_str_00104_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_2" FieldName="v03_str_00152_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_3" FieldName="v03_str_00200_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_4" FieldName="v03_str_00248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_5" FieldName="v03_str_00296_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_6" FieldName="v03_str_00344_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_7" FieldName="v03_str_00392_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_8" FieldName="v03_str_00440_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_9" FieldName="v03_str_00488_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_10" FieldName="v03_str_00536_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_vol_1" FieldName="v03_num_00576_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00264_008"/><Variable FieldBusinessName="_o_beneficiary_11" FieldName="v03_str_00584_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_vol_2" FieldName="v03_num_00624_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00272_008"/><Variable FieldBusinessName="_o_vol_3" FieldName="v03_num_00632_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00280_008"/><Variable FieldBusinessName="_o_vol_4" FieldName="v03_num_00640_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00288_008"/><Variable FieldBusinessName="_o_vol_5" FieldName="v03_num_00648_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00296_008"/><Variable FieldBusinessName="_o_vol_6" FieldName="v03_num_00656_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00304_008"/></VariableList></Rule><Rule ruleId="60254" baseRuleId="60252" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Dormant_Account]]></name><code><![CDATA[/*Array of UV storing beneficiary accounts*/
%DeclareArray(&rule.beneficiary, _o_beneficiary_1 - _o_beneficiary_11);
/*Array of UV storing the volume of payments that have been
made to the beneficiary*/
%DeclareArray(&rule.BNF_payment_vol , _o_vol_1 - _o_vol_11);


/* locate beneficiary for current payment in array*/
&rule.index = %IndexArray(&rule.beneficiary, tpp_acct_num);
/*check if this is the first payment to the beneficiary*/
if %get(&rule.BNF_payment_vol, &rule.index) = 1
then do;

 /*check if previous payment on the account was made over 6 months ago*/
 if rqo_tran_date - datepart(_o_dt_2) > 180

 /*account has been open for more than 6 months */
 /*_u_8byte_string_001 - account open date*/
 and rqo_tran_date - input(_u_8byte_string_001,date9.) > 180

 then do;
  %Action_Decline;
  %Action_Alert;
 end;

end;]]></code><desc><![CDATA[Transaction made from a dormant account.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_beneficiary_1" FieldName="v03_str_00104_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_2" FieldName="v03_str_00152_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_3" FieldName="v03_str_00200_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_4" FieldName="v03_str_00248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_5" FieldName="v03_str_00296_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_6" FieldName="v03_str_00344_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_7" FieldName="v03_str_00392_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_u_8byte_string_001" FieldName="rua_8byte_string_001" InitialValue="" FieldDesc="8-byte string" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="" SegmentKeyFieldBusinessNames="" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_8" FieldName="v03_str_00440_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_2" FieldName="v03_num_01440_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_9" FieldName="v03_str_00488_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_10" FieldName="v03_str_00536_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_vol_1" FieldName="v03_num_00576_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00264_008"/><Variable FieldBusinessName="_o_beneficiary_11" FieldName="v03_str_00584_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_vol_2" FieldName="v03_num_00624_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00272_008"/><Variable FieldBusinessName="_o_vol_3" FieldName="v03_num_00632_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00280_008"/><Variable FieldBusinessName="_o_vol_4" FieldName="v03_num_00640_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00288_008"/><Variable FieldBusinessName="_o_vol_5" FieldName="v03_num_00648_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00296_008"/><Variable FieldBusinessName="_o_vol_6" FieldName="v03_num_00656_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00304_008"/><Variable FieldBusinessName="_o_vol_7" FieldName="v03_num_00664_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00312_008"/><Variable FieldBusinessName="_o_vol_8" FieldName="v03_num_00672_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00320_008"/><Variable FieldBusinessName="_o_vol_9" FieldName="v03_num_00680_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00328_008"/><Variable FieldBusinessName="_o_vol_10" FieldName="v03_num_00688_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00336_008"/><Variable FieldBusinessName="_o_vol_11" FieldName="v03_num_00696_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00344_008"/></VariableList></Rule><Rule ruleId="60255" baseRuleId="60253" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[High_Value_Payment]]></name><code><![CDATA[if tbt_tran_amt > aqd_avail_bal * 0.8
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[High value payment of 80% of account balance to a beneficiary
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="60256" baseRuleId="60254" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[High_Velocity]]></name><code><![CDATA[/*Array of UV storing Transaction Date and Time*/
%DeclareArray(&rule.payment_dt , _o_dt_1 - _o_dt_11);

&rule.x = 0;

/* calculate how many payments have been made in the last 24 hours*/
do &rule.i = 1 to 11;

  if %get(&rule.payment_dt,&rule.i)> dhms(rqo_tran_date,0,0,rqo_tran_time)
                                - dhms(1,0,0,0)
  then &rule.x = &rule.x +1;
end;


if &rule.x > 6
then do;
 %Action_Decline;
 %Action_Alert;
end;]]></code><desc><![CDATA[Recently abnormally high number of transactions on Customer account.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_dt_9" FieldName="v03_num_01368_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_10" FieldName="v03_num_01376_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_7" FieldName="v03_num_01384_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_8" FieldName="v03_num_01392_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_5" FieldName="v03_num_01400_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_6" FieldName="v03_num_01408_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_3" FieldName="v03_num_01416_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_4" FieldName="v03_num_01424_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_1" FieldName="v03_num_01432_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_2" FieldName="v03_num_01440_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_11" FieldName="v03_num_01512_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60257" baseRuleId="60255" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Multiple_Payments _Same_Beneficiary]]></name><code><![CDATA[/*Array of UV storing Beneficiary Account*/
%DeclareArray(&rule.BNF_acct, _o_bnf_acct_1 - _o_bnf_acct_11);
/*Array  of UV storing Transaction Date and Time*/
%DeclareArray(&rule.payment_dt , _o_dt_1 - _o_dt_11);

&rule.X = 1;

/* checking if the previous 3 beneficiaries have been the
same as the current one*/
do &rule.i = 2 to 4;

 if %get(&rule.BNF_acct, &rule.i-1) = %get(&rule.BNF_acct, &rule.i)
 then &rule.X = &rule.X+1;

end;

if &rule.X = 4 /*4 payments to the same merchant in a row*/
and _o_dt_1 - _o_dt_4 < dhms(0,0,30,0) /* all 4 within 30 mins*/
then do;
 %Action_Decline;
 %Action_Alert;
end;]]></code><desc><![CDATA[Within short period of time multiple payments to the same Beneficiary are performed.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_bnf_acct_2" FieldName="v03_str_01048_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_1" FieldName="v03_str_01088_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_4" FieldName="v03_str_01128_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_3" FieldName="v03_str_01168_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_6" FieldName="v03_str_01208_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_5" FieldName="v03_str_01248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_8" FieldName="v03_str_01288_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_7" FieldName="v03_str_01328_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_9" FieldName="v03_num_01368_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_10" FieldName="v03_num_01376_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_7" FieldName="v03_num_01384_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_8" FieldName="v03_num_01392_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_5" FieldName="v03_num_01400_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_6" FieldName="v03_num_01408_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_3" FieldName="v03_num_01416_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_4" FieldName="v03_num_01424_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_1" FieldName="v03_num_01432_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_2" FieldName="v03_num_01440_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_10" FieldName="v03_str_00888_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_9" FieldName="v03_str_00928_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_11" FieldName="v03_num_01512_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_bnf_acct_11" FieldName="v03_str_00976_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60258" baseRuleId="60256" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Zeus Trojans" executionOrderType="0"><name><![CDATA[Unusual_Amount]]></name><code><![CDATA[/*Array of UV storing Transaction Amounts*/
%DeclareArray(&rule.payment_amt , _o_amt_1 - _o_amt_11);

&rule.tot = sum(&&&rule.payment_amt) - tbt_tran_amt;
&rule.ave = &rule.tot/10;

if tbt_tran_amt > _o_prev_max   /*greater than previous Max amt
                                 from last 11 payments*/
and tbt_tran_amt > &rule.ave * 1.3 /* 30% greater than last 10 payment average*/
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Payment 30% greater than last 10 transaction average and higher than previous maximum.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_amt_3" FieldName="v03_num_01016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_2" FieldName="v03_num_01024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_5" FieldName="v03_num_01032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_4" FieldName="v03_num_01040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_10" FieldName="v03_num_01448_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_11" FieldName="v03_num_01456_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_8" FieldName="v03_num_01464_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_9" FieldName="v03_num_01472_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_6" FieldName="v03_num_01480_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_7" FieldName="v03_num_01488_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_prev_max" FieldName="v03_num_01504_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_1" FieldName="v03_num_00968_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60259" baseRuleId="60257" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[New_Beneficiary_Unusual _Amount]]></name><code><![CDATA[/*Array of UV storing beneficiary accounts*/
%DeclareArray(&rule.beneficiary, _o_beneficiary_1 - _o_beneficiary_11);
/*Array of UV storing the date when the beneficiary was 1st paid*/
%DeclareArray(&rule.firstpayment, _o_1st_paid_1 - _o_1st_paid_11);

/*locate the current beneficiary in the array*/
&rule.index = %IndexArray(&rule.beneficiary, tpp_acct_num);
/*check if first payment date of beneficiary is today*/
if %get(&rule.firstpayment, &rule.index) = rqo_tran_date
then do;

/*Array of UV storing Transaction Amounts*/
  %DeclareArray(&rule.payment_amt , _o_amt_1 - _o_amt_11);

  &rule.tot = sum(&&&rule.payment_amt) - tbt_tran_amt;
  &rule.ave = &rule.tot/10;

/*calculate standard deviation*/
  &rule.x = 0;
  &rule.std = 0;

  do &rule.i = 2 to 11;
     &rule.x = &rule.x +
              ((%get(&rule.payment_amt, &rule.i) - &rule.ave)
             *(%get(&rule.payment_amt, &rule.i) - &rule.ave));
  end;

  &rule.std = sqrt(&rule.x / 10);

  if tbt_tran_amt > &rule.ave + &rule.std
  then do;
   %Action_Decline;
   %Action_Alert;
  end;

end;]]></code><desc><![CDATA[A new beneficiary is added and a transaction is made that is statistically larger than average transaction size for this customer.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_1st_paid_8" FieldName="v03_num_00056_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00144_008"/><Variable FieldBusinessName="_o_amt_3" FieldName="v03_num_01016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_9" FieldName="v03_num_00064_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00152_008"/><Variable FieldBusinessName="_o_amt_2" FieldName="v03_num_01024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_10" FieldName="v03_num_00072_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00160_008"/><Variable FieldBusinessName="_o_amt_5" FieldName="v03_num_01032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_11" FieldName="v03_num_00080_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00168_008"/><Variable FieldBusinessName="_o_amt_4" FieldName="v03_num_01040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_1" FieldName="v03_str_00104_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_2" FieldName="v03_str_00152_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_3" FieldName="v03_str_00200_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_4" FieldName="v03_str_00248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_5" FieldName="v03_str_00296_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_6" FieldName="v03_str_00344_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_7" FieldName="v03_str_00392_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_8" FieldName="v03_str_00440_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_9" FieldName="v03_str_00488_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_10" FieldName="v03_num_01448_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_11" FieldName="v03_num_01456_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_10" FieldName="v03_str_00536_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_8" FieldName="v03_num_01464_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_9" FieldName="v03_num_01472_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_11" FieldName="v03_str_00584_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_6" FieldName="v03_num_01480_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_7" FieldName="v03_num_01488_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_1" FieldName="v03_num_00000_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00088_008"/><Variable FieldBusinessName="_o_1st_paid_2" FieldName="v03_num_00008_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00096_008"/><Variable FieldBusinessName="_o_1st_paid_3" FieldName="v03_num_00016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00104_008"/><Variable FieldBusinessName="_o_1st_paid_4" FieldName="v03_num_00024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00112_008"/><Variable FieldBusinessName="_o_1st_paid_5" FieldName="v03_num_00032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00120_008"/><Variable FieldBusinessName="_o_1st_paid_6" FieldName="v03_num_00040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00128_008"/><Variable FieldBusinessName="_o_amt_1" FieldName="v03_num_00968_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_7" FieldName="v03_num_00048_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00136_008"/></VariableList></Rule><Rule ruleId="60260" baseRuleId="60258" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[First_International_Payment]]></name><code><![CDATA[/*customer country code not equal to beneficiary bank country code*/
if xqo_cust_cntry_code ne tpp_bank_cntry_code
/*2nd variable in international payment array is blank
indicating first international payment*/
and _o_intl_2 = ' '
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[First International payment ever made by the customer
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_intl_2" FieldName="v03_str_01520_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60261" baseRuleId="60259" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[New_Customer]]></name><code><![CDATA[/* _u_8byte_string_001 is account open date, may need to       */
/* change the input format depending on how the data is mapped */
/* account opened within two weeks                             */
if rqo_tran_date - input(_u_8byte_string_001,date9.) < 14
/* first day payments have ever been made by customer*/
and _o_first_payment_date = rqo_tran_date
and tbt_tran_amt > aqd_avail_bal *0.75
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Customer recently opened account at the bank and the day the first payments are made are within 2 weeks of account opening and a payment is >75% of the account balance.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_u_8byte_string_001" FieldName="rua_8byte_string_001" InitialValue="" FieldDesc="8-byte string" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="" SegmentKeyFieldBusinessNames="" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_first_payment_date" FieldName="v03_num_01552_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60262" baseRuleId="60260" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Preceding_Me_To_Me_Transaction]]></name><code><![CDATA[if tbt_self_acct_ind ne 'Y' /*indicates Me-To-Me transaction*/
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _o_me_to_me < dhms(0,1,0,0)
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Transaction preceded by a Me-to-Me transaction emptying account or at maximum limit for transfer type
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_me_to_me" FieldName="v03_num_01560_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60263" baseRuleId="60261" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Malware_Threat]]></name><code><![CDATA[if rqo_tran_date - datepart(_o_1st_online_session) < 2
and tbt_tran_amt > 10000
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[First internet login with a high value payment within a short timeframe
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_1st_online_session" FieldName="v03_num_01568_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60264" baseRuleId="60262" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Zeus Trojans" executionOrderType="0"><name><![CDATA[High_Total_Spend]]></name><code><![CDATA[/*Array to store Transaction Amounts*/
%DeclareArray(&rule.payment_amt , _o_amt_1 - _o_amt_11);
/*Array to store Transaction Date and Time*/
%DeclareArray(&rule.payment_dt , _o_dt_1 - _o_dt_11);

&rule.total_spend = 0;

do &rule.i = 1 to 11;
/*determine if payments in array are within 2 hours*/
  if dhms(rqo_tran_date,0,0,rqo_tran_time)
                               - %get(&rule.payment_dt,&rule.i)< dhms(0,2,0,0)
  then do;
/*if they are add payment amount to total*/
     &rule.total_spend = &rule.total_spend + %get(&rule.payment_amt, &rule.i);
  end;
/* end loop once first payment over two hours before is found*/
  else &rule.i = 12;
end;

if &rule.total_spend > 25000

then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Total amount of recent transactions is greater than a certain amount.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_amt_3" FieldName="v03_num_01016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_2" FieldName="v03_num_01024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_5" FieldName="v03_num_01032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_4" FieldName="v03_num_01040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_9" FieldName="v03_num_01368_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_10" FieldName="v03_num_01376_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_7" FieldName="v03_num_01384_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_8" FieldName="v03_num_01392_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_5" FieldName="v03_num_01400_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_6" FieldName="v03_num_01408_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_3" FieldName="v03_num_01416_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_4" FieldName="v03_num_01424_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_1" FieldName="v03_num_01432_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_2" FieldName="v03_num_01440_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_10" FieldName="v03_num_01448_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_11" FieldName="v03_num_01456_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_8" FieldName="v03_num_01464_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_9" FieldName="v03_num_01472_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_6" FieldName="v03_num_01480_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_7" FieldName="v03_num_01488_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_amt_1" FieldName="v03_num_00968_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Numeric" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_dt_11" FieldName="v03_num_01512_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60265" baseRuleId="60263" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Account_Takeover]]></name><code><![CDATA[if rqo_tran_date - _o_change_dt_3 < 30
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Frequent detail changes
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_change_dt_3" FieldName="v03_num_01576_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60266" baseRuleId="60264" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Multiple_Payments_In]]></name><code><![CDATA[/*Array of UV storing the date the beneficiary was paid by the customer*/
%DeclareArray(&rule.paidintodt, _b_paidintodt_1 - _b_paidintodt_11);

 &rule.x = 0;

/*count the number of accounts that have paid into the BNF in the last 2 hours*/

 do &rule.I = 1 to 11;
  if %get(&rule.paidintodt, &rule.I) > dhms(rqo_tran_date,0,0,rqo_tran_time)
                                      - dhms(0,2,0,0)
    then do ;
      &rule.x = &rule.x + 1;
    end;
 end;

if &rule.x > 5
and tpp_entity_type ne 'M'/*beneficiary is not a merchant*/
then do;
  %Action_Decline;
  %Action_Alert;
end;]]></code><desc><![CDATA[Within a short space of time payments from multiple different customer accounts are made to the same beneficiary.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="60267" baseRuleId="60265" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[New_Beneficiary_Low_Value]]></name><code><![CDATA[/*Array of UV storing beneficiary accounts*/
%DeclareArray(&rule.beneficiary, _o_beneficiary_1 - _o_beneficiary_11);
/*Array of UV storing the date when the beneficiary was 1st paid*/
%DeclareArray(&rule.firstpayment, _o_1st_paid_1 - _o_1st_paid_11);

/*locate the current beneficiary in the array*/
&rule.index = %IndexArray(&rule.beneficiary, tpp_acct_num);
/*check if first payment date of beneficiary is today*/
if %get(&rule.firstpayment, &rule.index) = rqo_tran_date
and tbt_tran_amt < 5
then do;
%Action_Hold;
end;]]></code><desc><![CDATA[A low value transaction is being made to new Beneficiary (trial transaction before performing higher amount fraud)]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_1st_paid_8" FieldName="v03_num_00056_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00144_008"/><Variable FieldBusinessName="_o_1st_paid_9" FieldName="v03_num_00064_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00152_008"/><Variable FieldBusinessName="_o_1st_paid_10" FieldName="v03_num_00072_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00160_008"/><Variable FieldBusinessName="_o_1st_paid_11" FieldName="v03_num_00080_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00168_008"/><Variable FieldBusinessName="_o_beneficiary_1" FieldName="v03_str_00104_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_2" FieldName="v03_str_00152_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_3" FieldName="v03_str_00200_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_4" FieldName="v03_str_00248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_5" FieldName="v03_str_00296_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_6" FieldName="v03_str_00344_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_7" FieldName="v03_str_00392_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_8" FieldName="v03_str_00440_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_9" FieldName="v03_str_00488_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_10" FieldName="v03_str_00536_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_11" FieldName="v03_str_00584_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_1" FieldName="v03_num_00000_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00088_008"/><Variable FieldBusinessName="_o_1st_paid_2" FieldName="v03_num_00008_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00096_008"/><Variable FieldBusinessName="_o_1st_paid_3" FieldName="v03_num_00016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00104_008"/><Variable FieldBusinessName="_o_1st_paid_4" FieldName="v03_num_00024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00112_008"/><Variable FieldBusinessName="_o_1st_paid_5" FieldName="v03_num_00032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00120_008"/><Variable FieldBusinessName="_o_1st_paid_6" FieldName="v03_num_00040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00128_008"/><Variable FieldBusinessName="_o_1st_paid_7" FieldName="v03_num_00048_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00136_008"/></VariableList></Rule><Rule ruleId="60268" baseRuleId="60266" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Language_Change]]></name><code><![CDATA[/*current language different to previously used language*/
if hdf_http_accept_lang ne _o_prev_lang
/*language changed in the last 2 hours*/
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _o_prev_lang_dt < dhms(0,2,0,0)
then do;
  %Action_Decline;
  %Action_Alert;
end;]]></code><desc><![CDATA[Customer has recently changed his preferred language on online banking interface or device.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_prev_lang" FieldName="v03_str_01632_032" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="32" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_prev_lang_dt" FieldName="v03_num_01672_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60269" baseRuleId="60267" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[New_Device_Type]]></name><code><![CDATA[/*Array of UV storing Device Types used*/
%DeclareArray(&rule.device_type, _o_device_1, _o_device_2, _o_device_3);
/*Array of UV storing first time device type used*/
%DeclareArray(&rule.device_date,_o_device_date_1,
                                    _o_device_date_2, _o_device_date_3);

/*locate device type in array*/
&rule.index = %IndexArray(&rule.device_type, hob_device);

if %get(&rule.device_date, &rule.index) = rqo_tran_date
and tbt_tran_amt > aqd_avail_bal*0.75
then do;
 %Action_Decline;
 %Action_Alert;
end;]]></code><desc><![CDATA[Customer is connecting to the online banking system using a new device type that they have never used before today and they are making a payment >75% of the account balance
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_device_date_1" FieldName="v03_num_01704_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_date_2" FieldName="v03_num_01712_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_date_3" FieldName="v03_num_01720_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_1" FieldName="v03_str_01680_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_2" FieldName="v03_str_01688_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_device_3" FieldName="v03_str_01696_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60270" baseRuleId="60268" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Zeus Trojans" executionOrderType="0"><name><![CDATA[New_Browser]]></name><code><![CDATA[/*Array of UV storing Browsers used*/
%DeclareArray(&rule.browser, _o_browser_1, _o_browser_2, _o_browser_3);
/*Array of UV storing first time browser is used*/
%DeclareArray(&rule.browser_date,_o_browser_date_1,
                                 _o_browser_date_2, _o_browser_date_3);

/*locate browser type in array*/
&rule.index = %IndexArray(&rule.browser, hdf_bwsr_type);

if %get(&rule.browser_date, &rule.index) = rqo_tran_date
and tbt_tran_amt > aqd_avail_bal*0.75
then do;
 %Action_Decline;
 %Action_Alert;
end;]]></code><desc><![CDATA[Customer's session is held from a web browser that has not been used before today and they are making a payment >75% of the account balance.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_browser_1" FieldName="v03_str_01728_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_2" FieldName="v03_str_01736_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_3" FieldName="v03_str_01744_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_date_1" FieldName="v03_num_01752_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_date_2" FieldName="v03_num_01760_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_browser_date_3" FieldName="v03_num_01768_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60271" baseRuleId="60269" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[New_OS]]></name><code><![CDATA[/*Array of UV storing Operating Systems used*/
%DeclareArray(&rule.os, _o_os_1, _o_os_2, _o_os_3);
/*Array of UV storing first time Operating System used*/
%DeclareArray(&rule.os_date,_o_os_date_1, _o_os_date_2, _o_os_date_3);

/* locate OS in array*/
&rule.index = %IndexArray(&rule.os, hdf_bwsr_os);

if %get(&rule.os_date, &rule.index) = rqo_tran_date
and tbt_tran_amt > aqd_avail_bal*0.75
then do;
 %Action_Decline;
 %Action_Alert;
end;]]></code><desc><![CDATA[Customer's session uses an Operating System that was not used before today ( Windows/ Mac OS X/ Linux ) and they are making a payment >75% of the account balance.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_os_1" FieldName="v03_str_01776_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_2" FieldName="v03_str_01784_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_3" FieldName="v03_str_01792_008" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_date_1" FieldName="v03_num_01800_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_date_2" FieldName="v03_num_01808_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_os_date_3" FieldName="v03_num_01816_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60272" baseRuleId="60270" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[New_Password]]></name><code><![CDATA[if dhms(rqo_tran_date,0,0,rqo_tran_time) - _o_passwd_change < dhms(0,0,10,0)
and tbt_tran_amt > 5000
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Customer's transaction is high value and made shorty after a password change
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_passwd_change" FieldName="v03_num_01824_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60273" baseRuleId="60271" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[New_Authorisation_Settings]]></name><code><![CDATA[/*Array of UV storing beneficiary accounts*/
%DeclareArray(&rule.beneficiary, _o_beneficiary_1 - _o_beneficiary_11);
/*Array of UV storing the date when the beneficiary was 1st paid*/
%DeclareArray(&rule.firstpayment, _o_1st_paid_1 - _o_1st_paid_11);

/*locate the current beneficiary in the array*/
&rule.index = %IndexArray(&rule.beneficiary, tpp_acct_num);
/*check if first payment date of beneficiary is today*/
if %get(&rule.firstpayment, &rule.index) = rqo_tran_date
/*check if auth settings have been modified within two days of this payment*/
and dhms(rqo_tran_date,0,0,rqo_tran_time)
                - _o_auth_settings_change < dhms(2,0,0,0)
and tbt_tran_amt > 50000
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Payment to new beneficiary is high value and shortly following change of authorisation settings, such as changes in daily or transactional limits for a user.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_1st_paid_8" FieldName="v03_num_00056_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00144_008"/><Variable FieldBusinessName="_o_auth_settings_change" FieldName="v03_num_01832_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_9" FieldName="v03_num_00064_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00152_008"/><Variable FieldBusinessName="_o_1st_paid_10" FieldName="v03_num_00072_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00160_008"/><Variable FieldBusinessName="_o_1st_paid_11" FieldName="v03_num_00080_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00168_008"/><Variable FieldBusinessName="_o_beneficiary_1" FieldName="v03_str_00104_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_2" FieldName="v03_str_00152_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_3" FieldName="v03_str_00200_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_4" FieldName="v03_str_00248_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_5" FieldName="v03_str_00296_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_6" FieldName="v03_str_00344_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_7" FieldName="v03_str_00392_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_8" FieldName="v03_str_00440_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_9" FieldName="v03_str_00488_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_10" FieldName="v03_str_00536_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_beneficiary_11" FieldName="v03_str_00584_040" InitialValue="" FieldDesc="Variable in Online User ID" FieldLength="40" VariableType="Character" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_o_1st_paid_1" FieldName="v03_num_00000_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00088_008"/><Variable FieldBusinessName="_o_1st_paid_2" FieldName="v03_num_00008_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00096_008"/><Variable FieldBusinessName="_o_1st_paid_3" FieldName="v03_num_00016_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00104_008"/><Variable FieldBusinessName="_o_1st_paid_4" FieldName="v03_num_00024_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00112_008"/><Variable FieldBusinessName="_o_1st_paid_5" FieldName="v03_num_00032_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00120_008"/><Variable FieldBusinessName="_o_1st_paid_6" FieldName="v03_num_00040_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00128_008"/><Variable FieldBusinessName="_o_1st_paid_7" FieldName="v03_num_00048_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="Date" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***" VariableDataPop="v03_num_00136_008"/></VariableList></Rule><Rule ruleId="60274" baseRuleId="60272" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 2 - Other Malware" executionOrderType="0"><name><![CDATA[Preceding_OverLimit_Payment]]></name><code><![CDATA[if dhms(rqo_tran_date,0,0,rqo_tran_time) ne _o_over_limit
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _o_over_limit
           < dhms(0,0,30,0)
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Transaction preceded shortly by a transaction that was over the available account balance.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_over_limit" FieldName="v03_num_01840_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60275" baseRuleId="60273" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Beneficiary_Name_Watch_List]]></name><code><![CDATA[if %ListContains(Beneficiary_Watch_List, tpp_name)
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Beneficiary name associated with a transaction matches a known high risk beneficiary on a bank watch list.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="60276" baseRuleId="60274" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 2 - Other Malware" executionOrderType="0"><name><![CDATA[IP_Associated_With_ATO]]></name><code><![CDATA[if %ListContains(ATO_IP_Watch_List, hob_ip_address)
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[The IP Address being used is connected to known Account Takeover (ATO) based on a ATO list maintained by the Bank.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="60277" baseRuleId="60275" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Known_Mule_Accounts]]></name><code><![CDATA[if %ListContains(Mule_Accounts, tpp_acct_num)
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[The transaction is being made to known mule account.
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="60278" baseRuleId="60276" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="Priority 2 - Other Malware" executionOrderType="0"><name><![CDATA[Infected Device]]></name><code><![CDATA[/*data from external system passed to rua_ind_021*/
if _u_ind_021 = 'I' /*Device infected*/
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[The status of the device  (passed to SAS FM by another system) is infected. Device may be infected with malware.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_u_ind_021" FieldName="rua_ind_021" InitialValue="" FieldDesc="Indicator/flag field" FieldLength="1" VariableType="Character" SegmentKeyFieldNames="" SegmentKeyFieldBusinessNames="" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="60279" baseRuleId="60277" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Coding" queue="BF - Premium" executionOrderType="0"><name><![CDATA[Multiple failed logins]]></name><code><![CDATA[if dhms(rqo_tran_date,0,0,rqo_tran_time)
           - _o_failed_2 < dhms(0,0,30,0)
and tbt_tran_amt > aqd_avail_bal*0.80
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Customer fails multiple times to login and then a payment >80% of the account balance is attempted within short timeframe.]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[R]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="BF"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DBA"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_o_failed_2" FieldName="v03_num_01856_008" InitialValue="0" FieldDesc="Variable in Online User ID" FieldLength="8" VariableType="DateTime" SegmentKeyFieldNames="hqo_ob_userid" SegmentKeyFieldBusinessNames="hqo_ob_userid" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule></RuleList>
