<?xml version="1.0" encoding="UTF-8"?>
<RuleList messageAPIVersion="M060100" applicationVersion="601000.2.0.20190529190000_d4rapt61" rulesCatalogVersion="4.4.20171017" ruleExportVersion="3.0"><Rule ruleId="54128" baseRuleId="54106" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[CNP_Tran_Datetime]]></name><code><![CDATA[/* Store date and time of a CNP transaction with amount less than 5 */

if ucm_card_present = '1'
and tca_client_amt < 5
then do;
%set(_c_tran_dt ) = dhms(rqo_tran_date,0,0,rqo_tran_time);
%Action_fire;
end;]]></code><desc><![CDATA[Store date and time of a CNP transaction with amount less than 5]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_tran_dt" FieldName="v04_num_00064_008" InitialValue="0" FieldDesc="Variable in Card transaction date-time" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54129" baseRuleId="54107" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Password_Reset_datetime]]></name><code><![CDATA[/*identify 3D secure password reset,
possibly using phone/online or low value auth*/

If tng_tran_type in ('PC','PW','OC','OW')
or index(hct_term_owner_name,'CA TECHNOLOGIES')

then do;
  %set(_c_pass_reset) = dhms(rqo_tran_date,0,0,rqo_tran_time);
  %Action_fire;
end;]]></code><desc><![CDATA[Store date and time of 3D secure password reset]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_pass_reset" FieldName="v04_num_00072_008" InitialValue="0" FieldDesc="Variable in Card. Capture password reset date time both phone and online" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="58516" baseRuleId="54108" version="2" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Travel_Indicators_Capture]]></name><code><![CDATA[/*Travel Indicators Capture*/

if ( ('3000' <= hct_mer_mcc <= '3299')      /* travel mccs */
    or
     ('3351' <= hct_mer_mcc <= '3441')
    or
     ('3500' <= hct_mer_mcc <= '3823')
    or hct_mer_mcc in ('4011','4111','4112','4131','4511',
                       '4582','4722','5962','7011','7512')
   )

then do;
  %set(_c_tt_dt_1) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store date and times of transactions which may indicate impending travel, for instance hotels, airlines, travel agencies]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_tt_dt_1" FieldName="v04_num_00080_008" InitialValue="0" FieldDesc="Variable in Card captures date-time for travel transactions" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54131" baseRuleId="54109" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Test_Transactions]]></name><code><![CDATA[/* Store dates and times of test(low value) transactions */
%DeclareArray(&rule.test_trans, _c_test_dt_1 - _c_test_dt_3);

if ucm_card_present = '1'
and tca_client_amt < 5
then do;
%ShiftHistoryArray(&rule.test_trans);
%set(_c_test_dt_1) =  dhms(Rqo_tran_date,0,0,rqo_tran_time);
%Action_fire;
end;]]></code><desc><![CDATA[ Store date and time of the last 3 low value transactions]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_test_dt_3" FieldName="v04_num_00088_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_test_dt_1" FieldName="v04_num_00096_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_test_dt_2" FieldName="v04_num_00104_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="58517" baseRuleId="54110" version="2" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Card_Present_Tracker]]></name><code><![CDATA[/*Card Present Tracker*/

if ucm_card_present = '0'
then do;
%set(_c_mer_cntry_2) = _c_mer_cntry_1;
%set( _c_custpres_dt_2) = _c_custpres_dt_1;
%set(_c_mer_cntry_1) = hct_term_cntry_code;
%set(_c_custpres_dt_1) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[ Store previous and current merchant country codes , dates and times for customer's card present spend.]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_mer_cntry_2" FieldName="v04_str_00112_008" InitialValue="" FieldDesc="Variable in Card captures merchant country for travel transactions" FieldLength="8" VariableType="Character                       " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_mer_cntry_1" FieldName="v04_str_00120_008" InitialValue="" FieldDesc="Variable in Card captures merchant country for travel transactions" FieldLength="8" VariableType="Character                       " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_custpres_dt_2" FieldName="v04_num_00128_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_custpres_dt_1" FieldName="v04_num_00136_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54133" baseRuleId="54111" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Acct Info change]]></name><code><![CDATA[/* change in password, contact details and/ or withdrawal limit */

if tng_tran_type in ('PC','OC','MM', 'GA', 'GP', 'LM')
/* password, contact details and/or withdrawal limit change*/

then do;
  %Set(_c_nonmon_chng) = dhms(rqo_tran_date,0,0,rqo_tran_time);
  %Action_fire;
end;]]></code><desc><![CDATA[Store the date and time of a change in password, contact details and/or withdrawal limit]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_nonmon_chng" FieldName="v04_num_00144_008" InitialValue="0" FieldDesc="Variable in Card - nonmon change or balance enquiry" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54134" baseRuleId="54112" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Foreign_Tran_Datetime]]></name><code><![CDATA[if xqo_cust_cntry_code ne hct_term_cntry_code  /*not customer's home country */
and ucm_card_present ='0' /*card present*/
then do;
%set(_c_foreign_prev_dt ) = _c_foreign_curr_dt;
%set(_c_foreign_curr_dt ) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store current and previous date and time when card has transacted abroad.]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_foreign_prev_dt" FieldName="v04_num_00152_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_foreign_curr_dt" FieldName="v04_num_00160_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54135" baseRuleId="54113" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Count_cvv2_cvc2_Failures]]></name><code><![CDATA[if ucm_card_present='1'
and ucm_cvv2_resp = 'N'

then do;

  if _c_date_cvv2cvc2= rqo_tran_date
  then
/*Increment counters*/
   %set(_c_count_cvv2cvc2) = _c_count_cvv2cvc2 + 1;

  else do;
/*Reset counters*/
   %set(_c_date_cvv2cvc2)= rqo_tran_date;
   %set(_c_count_cvv2cvc2) = 1;

  end;

end;]]></code><desc><![CDATA[Store the count of the cvv2/cvc2 failures for that day. Reset count on a new day.]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_date_cvv2cvc2" FieldName="v04_num_00168_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Date                            " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_count_cvv2cvc2" FieldName="v04_num_00176_008" InitialValue="0" FieldDesc="Variable in Card counts cvv2 cvc2 failures" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54136" baseRuleId="54114" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Count_cvv1_cvc1_failures]]></name><code><![CDATA[if ucm_card_present='0'
and ucm_pos ne '05'
and ucm_cvv_cvc = 'I' /*cvv_cvc failure */

then do;

  if _c_date_cvvcvc = rqo_tran_date
  then do;
/*Increment counters*/
   %set(_c_count_cvvcvc) = _c_count_cvvcvc + 1;
  end;
  else do;
/*Reset counters*/
   %set(_c_date_cvvcvc)= rqo_tran_date;
   %set(_c_count_cvvcvc) = 1;
  end;

end;]]></code><desc><![CDATA[Store a count of cvv1/cvc1 failures for that day. Reset count on a new day.]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_count_cvvcvc" FieldName="v04_num_00184_008" InitialValue="0" FieldDesc="Variable in Card counts failures in cvv1 or cvc1 failures per day" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_date_cvvcvc" FieldName="v04_num_00192_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Date                            " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54137" baseRuleId="54115" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[First_atm_datetime]]></name><code><![CDATA[if hct_mer_mcc = '6011'
and tca_auth_sys_dec = '1' /* host system approved*/
and tca_client_amt < 100
then
  %set(_c_frst_atm_dt) = dhms(rqo_tran_date,0,0,rqo_tran_time);]]></code><desc><![CDATA[Store date and time of ATM withdrawals of amounts under 100]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_frst_atm_dt" FieldName="v04_num_00200_008" InitialValue="0" FieldDesc="Variable in Card. captures first atm date time" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54138" baseRuleId="54116" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[ATM before midnight]]></name><code><![CDATA[if hct_mer_mcc = '6011'
and rqo_tran_time > '23:00:00't
and tca_client_amt > 0.9*hqo_limit_amt
then do;
   %set(_c_atm_dt) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store the date and time of an ATM transaction made after 11pm that is more than 90% of the ATM daily limit]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_atm_dt" FieldName="v04_num_00208_008" InitialValue="0" FieldDesc="Variable in Card. captures atm datetime" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54139" baseRuleId="54117" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Balance Enquiry Check]]></name><code><![CDATA[/* balance enquiry check */

if tng_tran_type = 'BE'
then do;
%set(_c_bal_chk) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store the date and time of a Balance Enquiry check ( Variable Rule - Balance Enquiry Check)
]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_authenticate_mtd" componentValue="UK"/><component componentField="smh_authenticate_mtd" componentValue="NA"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_channel_type" componentValue="O"/><component componentField="smh_channel_type" componentValue="W"/><component componentField="smh_channel_type" componentValue="P"/><component componentField="smh_channel_type" componentValue="H"/><component componentField="smh_channel_type" componentValue="M"/><component componentField="smh_channel_type" componentValue="B"/><component componentField="smh_channel_type" componentValue="R"/><component componentField="smh_channel_type" componentValue="U"/><component componentField="smh_activity_type" componentValue="NM"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNA"/><component componentField="smh_activity_detail1" componentValue="DNP"/><component componentField="smh_activity_detail1" componentValue="DNC"/><component componentField="smh_activity_detail1" componentValue="DNU"/><component componentField="smh_activity_detail1" componentValue="DNR"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DNO"/><component componentField="smh_activity_detail1" componentValue="DNX"/><component componentField="smh_activity_detail1" componentValue="DCB"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPP"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_bal_chk" FieldName="v04_num_00216_008" InitialValue="0" FieldDesc="Variable in Card. capture balance enquiry date time" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54140" baseRuleId="54118" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[ATM Spend Tracker]]></name><code><![CDATA[/* Array store 6 days (including current day) of total ATM spend */
%DeclareArray(&rule.atm_spend, _c_atm_spnd_1 - _c_atm_spnd_6);

if hct_mer_mcc = '6011'
and tca_auth_sys_dec = '1' /* host system approved*/
then do;

 %ShiftHistoryArray(&rule.atm_spend,_c_atm_spnd_dt,dhms(1,0,0,0), &rule.i);

  if &rule.i > 0
  then do;
  %set(&rule.atm_spend,&rule.i) =%get(&rule.atm_spend, &rule.i)+ tca_client_amt;
  end;

end;]]></code><desc><![CDATA[Store the daily total spend at ATMs for the last 5 days]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_atm_spnd_1" FieldName="v04_num_00224_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_5" FieldName="v04_num_00232_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_6" FieldName="v04_num_00240_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_dt" FieldName="v04_num_00248_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_4" FieldName="v04_num_00256_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_3" FieldName="v04_num_00264_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_2" FieldName="v04_num_00272_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54141" baseRuleId="54119" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Multiple low value auths]]></name><code><![CDATA[if ucm_card_present = '0'
and _c_lowval_date = rqo_tran_date
and tca_client_amt < 5
then do;
    %set(_c_lowval_cnt) = _c_lowval_cnt +1;

end;
else do;
    %set(_c_lowval_cnt) = 0;
    %set(_c_lowval_date)=rqo_tran_date;

end;]]></code><desc><![CDATA[Store a count of consecutive low value card present auths on the same day .]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_lowval_date" FieldName="v04_num_00280_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="Date                            " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_lowval_cnt" FieldName="v04_num_00288_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54142" baseRuleId="54120" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[ATM DT Tracker]]></name><code><![CDATA[%DeclareArray(&rule.atmdt , _c_dt_atm_1 - _c_dt_atm_3);

if hct_mer_mcc = '6011'
and tca_auth_sys_dec = '1' /* host system approved*/
then do;

%ShiftHistoryArray(&rule.atmdt);
%set(_c_dt_atm_1) = dhms(rqo_tran_date,0,0,rqo_tran_time);
end;]]></code><desc><![CDATA[Store date and time of the last two ATM withdrawals
]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_dt_atm_1" FieldName="v04_num_00296_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_dt_atm_3" FieldName="v04_num_00304_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_dt_atm_2" FieldName="v04_num_00312_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="58501" baseRuleId="58301" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Last transaction DT]]></name><code><![CDATA[%set(_c_last_tran_dt) = dhms(rqo_tran_date,0,0,rqo_tran_time);]]></code><desc><![CDATA[Store date and time of last transaction made on the card]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_last_tran_dt" FieldName="v04_num_02272_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="58503" baseRuleId="58303" version="1" type="Variable" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" executionOrderType="0"><name><![CDATA[Total Spend Tracker]]></name><code><![CDATA[/*Array of UV's storing total spend*/
%DeclareArray(&rule.tot_spend,_c_tot_spnd_1 - _c_tot_spnd_7);

if tca_auth_sys_dec = '1' /* host system approves transaction*/
then do;

 /*Each variable stores the total spend in a 10 minute period*/
 %ShiftHistoryArray(&rule.tot_spend, _c_tot_spnd_dt, dhms(0,0,10,0), &rule.i);

 if &rule.i > 0
 then do;
  %set(&rule.tot_spend, &rule.i) =
                    %get(&rule.tot_spend, &rule.i)+ tca_client_amt;
 end;

end;]]></code><desc><![CDATA[Stores total spend in 10 minutes periods regardless of whether spend is ATM,POS or Online]]></desc><alertReason><![CDATA[]]></alertReason><alertType><![CDATA[ ]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CS"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_tot_spnd_1" FieldName="v04_num_02280_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_tot_spnd_2" FieldName="v04_num_02288_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_tot_spnd_3" FieldName="v04_num_02296_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_tot_spnd_4" FieldName="v04_num_02304_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_tot_spnd_5" FieldName="v04_num_02312_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_tot_spnd_6" FieldName="v04_num_02320_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_tot_spnd_7" FieldName="v04_num_02328_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_tot_spnd_dt" FieldName="v04_num_02336_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54147" baseRuleId="54125" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[POS Risk - Overseas]]></name><code><![CDATA[/*If the transaction is card present Point of Sale
 and the merchant location is not in  the customer's home country
 and the model score is greater than 900
 the transaction is declined and an alert is created.*/

if ucm_card_present = '0'
and hct_mer_mcc ne '6011'
and hct_ch_cntry_code ne hct_term_cntry_code
and rrr_score_1 > 900

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[A card present Point of Sale transaction is being made overseas and is considered high risk based on model score]]></desc><alertReason><![CDATA[ Overseas CP POS, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54148" baseRuleId="54126" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[Highrisk fallback]]></name><code><![CDATA[/*If the transaction is fallback, over an amount of 1000
or in high risk countries or if the transaction is a mag stripe ATM
in high risk chip capable country
then the transaction is declined and an alert is created.*/

if (ucm_pos in ('79','80')
  and (tca_client_amt > 1000
      or
       %ListContains(High_Risk_Cntry_List,hct_term_cntry_code)
       )
    )
or
   ( hct_mer_mcc = '6011'
  and ucm_pos in ('80', '90')
  and ucm_term_pan_entry_cap in ('8','9') /* Chip capable terminal */
  and %ListContains(High_Risk_Cntry_List,hct_term_cntry_code )
    )

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Fallback transaction over certain amount or/and in high risk countries or mag stripe ATM in high risk chip capable country]]></desc><alertReason><![CDATA[ Fallback POS or Mag Stripe ATM, high value or high risk country]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54149" baseRuleId="54127" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[Invalid MCC's]]></name><code><![CDATA[/*If the MCC of the merchant is not in the industry standard list of MCC's
 and the amount is less than 10
 the transaction is declined and an alert is created.*/

if not %ListContains(Valid_MCC_list ,hct_mer_mcc)
and tca_client_amt < 10

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Merchant category information doesn't match standard scheme category codes]]></desc><alertReason><![CDATA[MCC doesn't match standard scheme category codes]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54150" baseRuleId="54128" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS2 - ATM Fraud" executionOrderType="0"><name><![CDATA[Large ATM Withdrawal Abroad]]></name><code><![CDATA[/*If the transaction is an ATM Withdrawal > 400
and is being made at a foreign ATM
the transaction is declined and an alert is created.*/

if hct_mer_mcc = '6011'
and hct_ch_cntry_code ne hct_term_cntry_code
and tca_client_amt > 400

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Large ATM withdrawal in a foreign country]]></desc><alertReason><![CDATA[ Large Overseas ATM withdrawal]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54151" baseRuleId="54129" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[POS Risk - Fallback]]></name><code><![CDATA[/*If the transaction is fallback at POS
 and the model score is greater than 800
 the transaction is declined and an alert
 is created.*/

if ucm_pos in ('79','80')
and hct_mer_mcc ne '6011'
and rrr_score_1 > 800

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Fallback POS transaction which is considered high risk based on model score]]></desc><alertReason><![CDATA[ Fallback POS, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54152" baseRuleId="54130" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 3 - Gross Loss fraud" executionOrderType="0"><name><![CDATA[POS Risk - Non Chip and Pin]]></name><code><![CDATA[/*If the transaction is mag stripe or keyed at POS
and the model score is greater than 900
the transaction is declined and an alert is created.*/

if ucm_pos in ('90','01')
and hct_mer_mcc ne '6011'
and rrr_score_1 > 900

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Mag Stripe or Keyed POS transaction which is considered high risk based on model score]]></desc><alertReason><![CDATA[Non Chip and PIN POS, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54153" baseRuleId="54131" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[POS Risk - Chip and Pin]]></name><code><![CDATA[/*If the transaction is chip and pin at POS
 and the model score is greater than 900
the transaction is declined and an alert is created*/

if ucm_pos = '05'
and hct_mer_mcc ne '6011'
and rrr_score_1 > 900

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Chip and Pin POS transaction which is considered high risk based on model score]]></desc><alertReason><![CDATA[ Chip and Pin POS, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54154" baseRuleId="54132" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[POS Risk - Domestic]]></name><code><![CDATA[/*If the transaction is card present Point of Sale
 and the merchant location is in the customer's home country
 and the model score is greater than 900
the transaction is declined and an alert is created.*/


if ucm_card_present = '0'
and hct_mer_mcc ne '6011'
and hct_ch_cntry_code = hct_term_cntry_code
and rrr_score_1 > 900

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[A card present Point of Sale transaction is being made in the customer's home country and is considered high risk based on model score]]></desc><alertReason><![CDATA[Domestic CP POS, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54155" baseRuleId="54133" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS1 - ATM Fraud" executionOrderType="0"><name><![CDATA[ATM Risk - Fallback]]></name><code><![CDATA[/*If the transaction is fallback at an ATM
and the model score is greater than 800
the transaction is declined and an alert is created.*/

if hct_mer_mcc = '6011'
and ucm_pos = '80'
and rrr_score_1 > 800

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Fallback ATM transaction which is considered high risk based on model score]]></desc><alertReason><![CDATA[ Fallback ATM, High score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54156" baseRuleId="54134" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS1 - ATM Fraud" executionOrderType="0"><name><![CDATA[ATM Risk - Mag Stripe]]></name><code><![CDATA[/*If the transaction is mag stripe at an ATM
and the model score is greater than 900
the transaction is declined and an alert is created.*/


If hct_mer_mcc = '6011'
and ucm_pos = '90'
and rrr_score_1 > 900

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Mag Stripe ATM transaction which is considered high risk based on model score]]></desc><alertReason><![CDATA[ Mag Stripe ATM, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54157" baseRuleId="54135" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS1 - ATM Fraud" executionOrderType="0"><name><![CDATA[ATM Risk - Chip and Pin]]></name><code><![CDATA[/*If the transaction is chip and pin at an ATM
and the model score is greater than 900
the transaction is declined and an alert is created.*/


if hct_mer_mcc = '6011'
and ucm_pos = '05'
and rrr_score_1 > 900

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Chip and Pin ATM transaction which is considered high risk based on model score
]]></desc><alertReason><![CDATA[ Chip and Pin ATM , High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54158" baseRuleId="54136" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="PF - ATM only card" executionOrderType="0"><name><![CDATA[ATM Risk - Overseas]]></name><code><![CDATA[/*If the transaction is at an ATM that is not in the customer's home country
and the model score is greater than 900
the transaction is declined and an alert is created.*/


IF hct_mer_mcc = '6011' /* ATM transaction */
and hct_ch_cntry_code ne hct_term_cntry_code  /*not in cardholder's country*/
and rrr_score_1 > 900

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[ATM transaction is being made overseas and is considered high risk based on model score]]></desc><alertReason><![CDATA[ Overseas ATM, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54159" baseRuleId="54137" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="PF - ATM only card" executionOrderType="0"><name><![CDATA[ATM Risk - Domestic]]></name><code><![CDATA[
/*If the transaction is at an ATM in the customer's home country
and the model score is greater than 850
the transaction is declined and an alert is created.*/

If hct_mer_mcc = '6011' /* ATM transaction */
and hct_ch_cntry_code = hct_term_cntry_code /* in cardholder's country */
and rrr_score_2 > 850

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[ATM transaction is being made in the customer's home country and is considered high risk based on model score]]></desc><alertReason><![CDATA[ Domestic ATM, High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54160" baseRuleId="54138" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[CNP Risk - Secure]]></name><code><![CDATA[/*If the transaction is card or customer not present,
 the transaction has been securely authenticated
and the model score is greater than 900
the transaction is declined and an alert is created.*/



If  /* customer or card not present */
(ucm_cust_present ne '0'
 or
ucm_card_present = '1')
and ucm_ch_evrfy ='2' /* secure authentication */
and rrr_score_1 > 900

then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Transaction completed when either / both customer or card is not present,  is securely authenticated and transaction is considered high risk based on model score]]></desc><alertReason><![CDATA[ CNP , Secure , High Score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="55501" baseRuleId="54139" version="3" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="PF - Debit Card" executionOrderType="0"><name><![CDATA[CNP Risk - Non Secure]]></name><code><![CDATA[
/*If the transaction is card or customer not present,
the transaction has not been securely authenticated
and the model score is greater than 950
 the transaction is declined and an alert is created.*/


If  /* customer or card not present */
(ucm_cust_present = '5'
or
ucm_card_present = '1')
and ucm_ch_evrfy ne '2' /* not securely authenticated*/
and rrr_score_2 > 950

then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Transaction completed when either / both customer or card is not present,  is not secure and transaction is considered high risk based on model score]]></desc><alertReason><![CDATA[ CNP , Unsecure , High score]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54162" baseRuleId="54140" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[Test Transaction - CNP]]></name><code><![CDATA[/* If the current transaction is CNP and the amount is over 500 and in the
preceding 30mins there was a transaction attempted that was of an amount
less than 5 then the current transaction is declined and an alert is created.*/


If ucm_card_present='1'
and tca_client_amt > 500
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _c_tran_dt < dhms(0,0,30,0)

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Card has a low value transaction attempted, followed by a high value transaction]]></desc><alertReason><![CDATA[High value CN preceded by tester.]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_tran_dt" FieldName="v04_num_00064_008" InitialValue="0" FieldDesc="Variable in Card transaction date-time" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54163" baseRuleId="54141" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 1 - Net Loss fraud" executionOrderType="0"><name><![CDATA[3D secure FYP]]></name><code><![CDATA[/* If the current transaction is CNP and securely authenticated and
a password reset transaction was in the preceding 30 mins and
the amount of the transaction is over 500 then the transaction
is declined and an alert is created. */


if ucm_pos = '81'
and ucm_ch_evrfy = '2'
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _c_pass_reset < dhms(0,0,30,0)
and tca_client_amt > 500

then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[3D secure password reset shortly before Ecommerce transaction]]></desc><alertReason><![CDATA[CNP preceded by 3D secure password reset]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_pass_reset" FieldName="v04_num_00072_008" InitialValue="0" FieldDesc="Variable in Card. Capture password reset date time both phone and online" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="58515" baseRuleId="54142" version="2" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[First Overseas - No Travel Precursor]]></name><code><![CDATA[/*If the current transaction is the first card present transaction
that the customer is making in this country and with in the last 7 days
there has been no spend indicating that the customer may be travelling
then the current transaction is declined and an alert is created.*/

if ucm_card_present = '0'
and hct_ch_cntry_code ne hct_term_cntry_code
and _c_mer_cntry_2 ne hct_term_cntry_code
and dhms(rqo_tran_date,0,0,rqo_tran_time) -
                          _c_tt_dt_1 > dhms(7,0,0,0)
and tca_client_amt > 200

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[First transaction made in a foreign country with no travel precursor]]></desc><alertReason><![CDATA[ Overseas, no evidence of planned travel]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_tt_dt_1" FieldName="v04_num_00080_008" InitialValue="0" FieldDesc="Variable in Card captures date-time for travel transactions" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_mer_cntry_2" FieldName="v04_str_00112_008" InitialValue="" FieldDesc="Variable in Card captures merchant country for travel transactions" FieldLength="8" VariableType="Character                       " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54165" baseRuleId="54143" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[High Risk Merchant Type]]></name><code><![CDATA[/*If MCC matches an MCC listed on Bank's watch list
then the transaction is declined and an alert is created.*/

if %ListContains(High_Risk_MCC_List ,hct_mer_mcc)
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Classification of MCC as high risk. Bank maintains a list of high risk merchant MCC types]]></desc><alertReason><![CDATA[ MCC on high risk list]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54166" baseRuleId="54144" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[High Fraud Merchant]]></name><code><![CDATA[/*If merchant matches a merchant listed on Bank's watch list
then the transaction is declined and an alert is created. */

if %ListContains(High_Risk_Mer_List ,hct_term_owner_id)
then do;
%Action_Decline;
%Action_Alert;
end;]]></code><desc><![CDATA[Classification of merchant as high risk. Bank will maintain a list of high risk merchants]]></desc><alertReason><![CDATA[ Merchant on High fraud prone list]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList/></Rule><Rule ruleId="54167" baseRuleId="54145" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[Multiple Test Transactions]]></name><code><![CDATA[/*If the transaction is CNP with an amount > 200
and there have been at least 3 low value transactions
made within the previous 30 mins
then decline the current transaction and create an alert.*/

%DeclareArray(&rule.test_trans, _c_test_dt_1 - _c_test_dt_3);

if ucm_card_present ='1'
and tca_client_amt > 200
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _c_test_dt_3 < dhms(0,0,30,0)

then do;
  %Action_decline;
  %Action_alert;
end;]]></code><desc><![CDATA[Card has a series of low value transactions is attempt, followed by a high value transaction]]></desc><alertReason><![CDATA[ High value CNP preceded by multiple testers]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_test_dt_3" FieldName="v04_num_00088_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_test_dt_1" FieldName="v04_num_00096_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_test_dt_2" FieldName="v04_num_00104_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54168" baseRuleId="54146" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[Customer detail changes]]></name><code><![CDATA[/*If the current transaction is being made within 5 days
of a change in password, contact details and/ or withdrawal limit,
and the total amount is  >= 400
then decline this transaction and create an alert.*/

if dhms(rqo_tran_date,0,0,rqo_tran_time) - _c_nonmon_chng < dhms(5,0,0,0)
and tca_client_amt >= 400

then do;
  %Action_decline;
  %Action_alert;
end;]]></code><desc><![CDATA[ Withdrawal or card transaction preceded by changes in key customer or account details.]]></desc><alertReason><![CDATA[Transaction preceded by changes in key customer or account details.]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_nonmon_chng" FieldName="v04_num_00144_008" InitialValue="0" FieldDesc="Variable in Card - nonmon change or balance enquiry" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54169" baseRuleId="54147" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="PF - ATM only card" executionOrderType="0"><name><![CDATA[ATM Abroad - Unusual]]></name><code><![CDATA[/*If the current transaction is an ATM withdrawal abroad
and the amount is >350
 and the customer has not used the card abroad within 12 months
then the transaction is declined and an alert is created. */

If hct_mer_mcc = '6011'
and xqo_cust_cntry_code ne hct_term_cntry_code
and tca_client_amt > 350
and dhms(rqo_tran_date,0,0,rqo_tran_time)-_c_foreign_prev_dt > dhms(365,0,0,0)

then do;
   %Action_Decline;
   %Action_Alert;
end;]]></code><desc><![CDATA[Unusual foreign withdrawals for customers
]]></desc><alertReason><![CDATA[Unusual foreign withdrawals]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_foreign_prev_dt" FieldName="v04_num_00152_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54170" baseRuleId="54148" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[Excessive cvv2/cvc2 failures]]></name><code><![CDATA[/*If the transaction is CNP
and there have been more than 18 cvv2/cvc2 failures on the same day
decline current transaction and create an alert.*/

if ucm_card_present = '1'
and _c_count_cvv2cvc2 > 18

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[A series of incorrect CVC2 values attempted
]]></desc><alertReason><![CDATA[ Excessive cvv2/cvc2 failures]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_count_cvv2cvc2" FieldName="v04_num_00176_008" InitialValue="0" FieldDesc="Variable in Card counts cvv2 cvc2 failures" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54171" baseRuleId="54149" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[Excessive cvv1/cvc1 failures]]></name><code><![CDATA[/*If the transaction is card present and not chip and pin
and there have been more than 18 cvv1/cvc1 failures on the same day
decline current transaction and create an alert*/

If  ucm_card_present = '0' /* card present */
and ucm_pos ne '05'  /* not chip and pin transaction */
and  _c_count_cvvcvc > 18

then do;
   %Action_decline;
   %Action_alert;
end;]]></code><desc><![CDATA[A series of incorrect CVC1 values
]]></desc><alertReason><![CDATA[Excessive cvv1/cvc1 failures]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_count_cvvcvc" FieldName="v04_num_00184_008" InitialValue="0" FieldDesc="Variable in Card counts failures in cvv1 or cvc1 failures per day" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54172" baseRuleId="54150" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS1 - ATM Fraud" executionOrderType="0"><name><![CDATA[Shoulder Surf]]></name><code><![CDATA[/*If transaction is an ATM withdrawal over 300
and in the previous 15 minutes there was an ATM withdrawal under 100
 then decline this transaction and create an alert.*/

if hct_mer_mcc = '6011'
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _c_frst_atm_dt < dhms(0,0,15,0)
and tca_client_amt > 300

then do;
   %Action_decline;
   %Action_alert;
end;]]></code><desc><![CDATA[Small initial withdrawal followed shortly by a large withdrawal attempt
]]></desc><alertReason><![CDATA[ Shoulder Surf]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_frst_atm_dt" FieldName="v04_num_00200_008" InitialValue="0" FieldDesc="Variable in Card. captures first atm date time" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54173" baseRuleId="54151" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS2 - ATM Fraud" executionOrderType="0"><name><![CDATA[ATM Before and After Midnight]]></name><code><![CDATA[/*If a large ATM withdrawal is made shortly before midnight
followed by another attempt to make a large ATM withdrawal
 shortly after midnight
this attempt will be declined and an alert will be created.*/

if hct_mer_mcc = '6011'
and datepart(_c_atm_dt) = rqo_tran_date - 1
and rqo_tran_time <= '01:00:00't
and tca_client_amt > 0.9*hqo_limit_amt

then do;
    %Action_decline;
    %Action_Alert;
end;]]></code><desc><![CDATA[Identifying instances where a fraudster is trying to empty a compromised card by withdrawing money just before and after midnight
]]></desc><alertReason><![CDATA[ ]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_atm_dt" FieldName="v04_num_00208_008" InitialValue="0" FieldDesc="Variable in Card. captures atm datetime" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54174" baseRuleId="54152" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS1 - ATM Fraud" executionOrderType="0"><name><![CDATA[Full limit Withdrawal]]></name><code><![CDATA[/*If there has been a Balance Enquiry in the last 10 mins
the withdrawal amount is the same as the daily limit amount
 the ATM withdrawal is declined and an alert is created.*/

if hct_mer_mcc = '6011'
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _c_bal_chk < dhms(0,0,10,0)
and tca_client_amt = hqo_limit_amt

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Balance check followed by withdrawal of full daily limit
]]></desc><alertReason><![CDATA[ Full limit Withdrawal]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_bal_chk" FieldName="v04_num_00216_008" InitialValue="0" FieldDesc="Variable in Card. capture balance enquiry date time" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54175" baseRuleId="54153" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS1 - ATM Fraud" executionOrderType="0"><name><![CDATA[Repeat ATM Max Withdrawals]]></name><code><![CDATA[/*If current transaction is an ATM withdrawal
and the total ATM spend for the day is >80% of the daily limit
and this has also occurred on 3 of the previous 5 days
then the current transaction is declined and an alert is created.*/

/* Array store 6 days of total ATM spend*/
%DeclareArray(&rule.atm_spend, _c_atm_spnd_1 - _c_atm_spnd_6);

if hct_mer_mcc = '6011'
then do;

  &rule.x = 0;

  do &rule.i = 2 to 6;
   if %get(&rule.atm_spend, &rule.i) > 0.8*hqo_limit_amt
   then &rule.x = &rule.x + 1;

  end;

  if _c_atm_spnd_1 > 0.8* hqo_limit_amt
     and &rule.x > 3
  then do;
  %Action_decline;
  %Action_alert;
  end;

end;]]></code><desc><![CDATA[ATM withdrawals nearing the maximum daily limit occur repeatedly for a certain period of time
]]></desc><alertReason><![CDATA[ Repeat ATM Max Withdrawals]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_atm_spnd_1" FieldName="v04_num_00224_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_5" FieldName="v04_num_00232_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_6" FieldName="v04_num_00240_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_4" FieldName="v04_num_00256_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_3" FieldName="v04_num_00264_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_atm_spnd_2" FieldName="v04_num_00272_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54176" baseRuleId="54154" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Other" executionOrderType="0"><name><![CDATA[First Party Fraud Contactless]]></name><code><![CDATA[/*if 6 or more low value card present auths
are seen consecutively on the same day
then decline the current low value card present transaction
and create an alert */

if ucm_card_present = '0'
and _c_lowval_date = rqo_tran_date
and tca_client_amt < 5
and _c_lowval_cnt >= 6

then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Multiple low value auths to reset counters on card , customer able to exceed credit limit
]]></desc><alertReason><![CDATA[ First Party Fraud Contactless]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_lowval_date" FieldName="v04_num_00280_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="Date                            " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_lowval_cnt" FieldName="v04_num_00288_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="Numeric                         " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="54177" baseRuleId="54155" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="FS1 - ATM Fraud" executionOrderType="0"><name><![CDATA[Rapid ATM withdrawals]]></name><code><![CDATA[/*If current transaction is an ATM withdrawal
 and in the last 10 mins there have already been 2 ATM withdrawals
then the transaction is declined and an alert is created.*/
%DeclareArray(&rule.atmdt , _c_dt_atm_1 - _c_dt_atm_3);
if hct_mer_mcc = '6011'
and dhms(rqo_tran_date,0,0,rqo_tran_time) - _c_dt_atm_3 < dhms(0,0,10,0)
then do;
%Action_decline;
%Action_alert;
end;]]></code><desc><![CDATA[Multiple ATM withdrawals in a short period of time
]]></desc><alertReason><![CDATA[Multiple ATM withdrawals in a short period of time]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_c_dt_atm_1" FieldName="v04_num_00296_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_dt_atm_3" FieldName="v04_num_00304_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_dt_atm_2" FieldName="v04_num_00312_008" InitialValue="0" FieldDesc="Variable in CARD" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule><Rule ruleId="58502" baseRuleId="58302" version="1" type="Authorization" multiOrgKey="A" multiOrgName="WORLD BANK" workflow="Production" queue="Priority 2  - Gross Loss fraud" executionOrderType="0"><name><![CDATA[Usage on dormant account]]></name><code><![CDATA[/*If the current transaction is being made on card
with a dormant account indicator or if the card has
not attempted to transact for over 6 months and the
account has been open for more than 6 months then
the transaction is declined and an alert is created.
*/

if _u_ind_001= 'D' /*Dormant Account indicator*/
   or
   (rqo_tran_date - datepart(_c_last_tran_dt) > 180
   and
/*account has been open for more than 6 months */
 /*_u_8byte_string_001 - account open date*/
   rqo_tran_date - input(_u_8byte_string_001,date9.) > 180
   )

then do;
  %Action_decline;
  %Action_alert;
end;]]></code><desc><![CDATA[Transaction made from a dormant account]]></desc><alertReason><![CDATA[Usage on a dormant account]]></alertReason><alertType><![CDATA[C]]></alertType><component componentField="smh_tran_type" componentValue="TRX"/><component componentField="smh_cust_type" componentValue="B"/><component componentField="smh_cust_type" componentValue="I"/><component componentField="smh_acct_type" componentValue="CC"/><component componentField="smh_authenticate_mtd" componentValue="CP"/><component componentField="smh_authenticate_mtd" componentValue="CD"/><component componentField="smh_authenticate_mtd" componentValue="NC"/><component componentField="smh_channel_type" componentValue="C"/><component componentField="smh_channel_type" componentValue="D"/><component componentField="smh_channel_type" componentValue="E"/><component componentField="smh_activity_type" componentValue="CA"/><component componentField="smh_activity_detail1" componentValue="NAP"/><component componentField="smh_activity_detail1" componentValue="DNS"/><component componentField="smh_activity_detail1" componentValue="DMX"/><component componentField="smh_activity_detail1" componentValue="DEE"/><component componentField="smh_activity_detail1" componentValue="DPD"/><component componentField="smh_activity_detail1" componentValue="DUA"/><VariableList><Variable FieldBusinessName="_u_8byte_string_001" FieldName="rua_8byte_string_001" InitialValue="" FieldDesc="8-byte string" FieldLength="8" VariableType="Character                       " SegmentKeyFieldNames="" SegmentKeyFieldBusinessNames="" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_c_last_tran_dt" FieldName="v04_num_02272_008" InitialValue="0" FieldDesc="Variable in Card" FieldLength="8" VariableType="DateTime                        " SegmentKeyFieldNames="hqo_card_num" SegmentKeyFieldBusinessNames="hqo_card_num" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/><Variable FieldBusinessName="_u_ind_001" FieldName="rua_ind_001" InitialValue="" FieldDesc="Indicator/flag field" FieldLength="1" VariableType="Character                       " SegmentKeyFieldNames="" SegmentKeyFieldBusinessNames="" SegmentKeyFieldName="***MULTIPLE_KEYS***" SegmentKeyFieldBusinessName="***MULTIPLE_KEYS***"/></VariableList></Rule></RuleList>
